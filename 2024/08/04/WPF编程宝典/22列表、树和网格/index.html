<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>WPF编程宝典 - 22列表、树和网格 | 生活中的tree</title><meta name="author" content="大白"><meta name="copyright" content="大白"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="得益于样式、数据模板以及控件模板提供的扩展功能，即使ListBox 控件(以及类似的ComboBox 控件)也可成为以各种方式显示数据的强大工具。然而，某些类型的数据表示形式只凭ListBox控件很难实现。幸运的是，WPE还提供了几个填补这一空白的富数据控件，包括以下几个控件:  ListView。ListView 继承自简单的没有特色的 ListBox。增加了对基于列显示的支持，并增加了快速">
<meta property="og:type" content="article">
<meta property="og:title" content="WPF编程宝典 - 22列表、树和网格">
<meta property="og:url" content="http://bootree.cn/2024/08/04/WPF%E7%BC%96%E7%A8%8B%E5%AE%9D%E5%85%B8/22%E5%88%97%E8%A1%A8%E3%80%81%E6%A0%91%E5%92%8C%E7%BD%91%E6%A0%BC/index.html">
<meta property="og:site_name" content="生活中的tree">
<meta property="og:description" content="得益于样式、数据模板以及控件模板提供的扩展功能，即使ListBox 控件(以及类似的ComboBox 控件)也可成为以各种方式显示数据的强大工具。然而，某些类型的数据表示形式只凭ListBox控件很难实现。幸运的是，WPE还提供了几个填补这一空白的富数据控件，包括以下几个控件:  ListView。ListView 继承自简单的没有特色的 ListBox。增加了对基于列显示的支持，并增加了快速">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://cnlicm-blog-image.oss-cn-shenzhen.aliyuncs.com/img/wpf.png">
<meta property="article:published_time" content="2024-08-04T13:29:31.000Z">
<meta property="article:modified_time" content="2024-09-20T15:30:57.357Z">
<meta property="article:author" content="大白">
<meta property="article:tag" content="WPF编程宝典">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://cnlicm-blog-image.oss-cn-shenzhen.aliyuncs.com/img/wpf.png"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="http://bootree.cn/2024/08/04/WPF%E7%BC%96%E7%A8%8B%E5%AE%9D%E5%85%B8/22%E5%88%97%E8%A1%A8%E3%80%81%E6%A0%91%E5%92%8C%E7%BD%91%E6%A0%BC/index.html"><link rel="preconnect" href="https://jsd.012700.xyz"/><link rel="preconnect" href="//fonts.googleapis.com" crossorigin=""/><link rel="preconnect" href="//busuanzi.ibruce.info"/><meta name="google-site-verification" content="NdIUXAOVyGnnBhcrip0ksCawbdAzT0hlBZDE9u4jx6k"/><meta name="msvalidate.01" content="567E47D75E8DCF1282B9623AD914701E"/><meta name="baidu-site-verification" content="code-pE5rnuxcfD"/><link rel="stylesheet" href="/css/index.css?v=4.13.0"><link rel="stylesheet" href="https://jsd.012700.xyz/npm/@fortawesome/fontawesome-free@6.5.1/css/all.min.css"><link rel="stylesheet" href="https://jsd.012700.xyz/npm/@fancyapps/ui@5.0.33/dist/fancybox/fancybox.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Titillium+Web&amp;display=swap" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":false,"top_n_per_article":1,"unescape":false,"languages":{"hits_empty":"找不到您查询的内容：${query}","hits_stats":"共找到 ${hits} 篇文章"}},
  translate: {"defaultEncoding":1,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"简"},
  noticeOutdate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":400},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: true,
    post: true
  },
  runtime: '天',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: {"limitCount":150,"languages":{"author":"作者: 大白","link":"链接: ","source":"来源: 生活中的tree","info":"著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。"}},
  lightbox: 'fancybox',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://jsd.012700.xyz/npm/@egjs/infinitegrid@4.11.1/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: false,
  islazyload: true,
  isAnchor: true,
  percent: {
    toc: true,
    rightside: true,
  },
  autoDarkmode: true
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'WPF编程宝典 - 22列表、树和网格',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2024-09-20 23:30:57'
}</script><script>(win=>{
      win.saveToLocal = {
        set: (key, value, ttl) => {
          if (ttl === 0) return
          const now = Date.now()
          const expiry = now + ttl * 86400000
          const item = {
            value,
            expiry
          }
          localStorage.setItem(key, JSON.stringify(item))
        },
      
        get: key => {
          const itemStr = localStorage.getItem(key)
      
          if (!itemStr) {
            return undefined
          }
          const item = JSON.parse(itemStr)
          const now = Date.now()
      
          if (now > item.expiry) {
            localStorage.removeItem(key)
            return undefined
          }
          return item.value
        }
      }
    
      win.getScript = (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        script.onerror = reject
        script.onload = script.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          script.onload = script.onreadystatechange = null
          resolve()
        }

        Object.keys(attr).forEach(key => {
          script.setAttribute(key, attr[key])
        })

        document.head.appendChild(script)
      })
    
      win.getCSS = (url, id = false) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onerror = reject
        link.onload = link.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          link.onload = link.onreadystatechange = null
          resolve()
        }
        document.head.appendChild(link)
      })
    
      win.activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          const isDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches
          const isLightMode = window.matchMedia('(prefers-color-scheme: light)').matches
          const isNotSpecified = window.matchMedia('(prefers-color-scheme: no-preference)').matches
          const hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

          if (t === undefined) {
            if (isLightMode) activateLightMode()
            else if (isDarkMode) activateDarkMode()
            else if (isNotSpecified || hasNoSupport) {
              const now = new Date()
              const hour = now.getHours()
              const isNight = hour <= 6 || hour >= 18
              isNight ? activateDarkMode() : activateLightMode()
            }
            window.matchMedia('(prefers-color-scheme: dark)').addListener(e => {
              if (saveToLocal.get('theme') === undefined) {
                e.matches ? activateDarkMode() : activateLightMode()
              }
            })
          } else if (t === 'light') activateLightMode()
          else activateDarkMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
      const detectApple = () => {
        if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
          document.documentElement.classList.add('apple')
        }
      }
      detectApple()
    })(window)</script><link rel="preconnect" href="https://jsd.012700.xyz"><link href="/self/btf.css" rel="stylesheet"><link rel="alternate" href="/atom.xml" title="生活中的tree" type="application/atom+xml">
<link href="https://cdn.bootcss.com/KaTeX/0.11.1/katex.min.css" rel="stylesheet" /></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src= "/img/loading.gif" data-lazy-src="/img/avatar.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">115</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">20</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">26</div></a></div><hr class="custom-hr"/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首頁</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);" rel="external nofollow noreferrer"><i class="fa-fw fas fa-compass"></i><span> 目录</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></li><li><a class="site-page child" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></li></ul></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);" rel="external nofollow noreferrer"><i class="fa-fw fa fa-heartbeat"></i><span> 娱乐</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/Gallery/"><i class="fa-fw fas fa-images"></i><span> 图库</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('https://cnlicm-blog-image.oss-cn-shenzhen.aliyuncs.com/img/wpf.png')"><nav id="nav"><span id="blog-info"><a href="/" title="生活中的tree"><span class="site-name">生活中的tree</span></a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search" href="javascript:void(0);" rel="external nofollow noreferrer"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首頁</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);" rel="external nofollow noreferrer"><i class="fa-fw fas fa-compass"></i><span> 目录</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></li><li><a class="site-page child" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></li></ul></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);" rel="external nofollow noreferrer"><i class="fa-fw fa fa-heartbeat"></i><span> 娱乐</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/Gallery/"><i class="fa-fw fas fa-images"></i><span> 图库</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);" rel="external nofollow noreferrer"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">WPF编程宝典 - 22列表、树和网格<a class="post-edit-link" href="https://github.com/cnlicm/HexoBlog/tree/main/source/_posts/WPF编程宝典/22列表、树和网格.md" rel="external nofollow noreferrer" title="编辑" target="_blank"><i class="fas fa-pencil-alt"></i></a></h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="fa-fw post-meta-icon far fa-calendar-alt"></i><span class="post-meta-label">发表于</span><time datetime="2024-08-04T13:29:31.000Z" title="发表于 2024-08-04 21:29:31">2024-08-04</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/C/">C#</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/C/WPF/">WPF</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">12.8k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>45分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="WPF编程宝典 - 22列表、树和网格"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><p>  得益于样式、数据模板以及控件模板提供的扩展功能，即使ListBox 控件(以及类似的ComboBox 控件)也可成为以各种方式显示数据的强大工具。然而，某些类型的数据表示形式只凭ListBox控件很难实现。幸运的是，WPE还提供了几个填补这一空白的富数据控件，包括以下几个控件:</p>
<ul>
<li><strong>ListView</strong>。ListView 继承自简单的没有特色的 ListBox。增加了对基于列显示的支持，并增加了快速切换视图或显示模式的能力，而不需要重新绑定数据以及重新构建列表。</li>
<li><strong>TreeView</strong>。TreeView时层次化容器，这意味个创建多层数据显示。例如，可创建在第一级中显示类别组，并在每个类别节点中显示相关产品的TreeView控件。</li>
<li><strong>DataGrid</strong>。DataGrid是WPF中功能最完备的数据显示工具。它将数据分割到包含行和列的网格中，就像ListView控件，但DataGrid控件具有其他格式化特性（比如冻结列以及设置单行样式的能力），并且支持就地编辑数据</li>
</ul>
<h2 id="listview控件">ListView控件</h2>
<p>  ListView 类是一个特殊的列表类，它是专门针对显示相同数据的不同视图而设计的。如果需要构建显示每个数据项几部分信息的多列视图，ListView控件特别有用。</p>
<p>  ListView 类继承自 ListBox类，并使用 View属性进行了扩展。View 属性是另一个扩展点,用于创建内容丰富的列表。如果没有设置 View 属性，ListView 控件的行为就类似于其功能较少的祖先 ListBox 控件的行为。然而，如果提供用于指示如何设置数据项格式和样式的视图对象，ListView 控件就变得更有趣了。</p>
<p>  <em>从技术角度看，View 属性指向继承自 VewBase 类(它是一个抽象类)的任意类的实例。ViewBase类非常简单——实际上，它只不过是一个将两个样式捆绑在一起的包。其中的一个样式应用到ListView 控件(并通过 DefaultStyleKey 属性加以引用)，而另一个样式应用到 ListView 控件中的项(并通过 ItemContainerDefaultStyleKey属性加以引用),DefaultStyleKey 和 ItemContainerDefaultStyleKey属性实际上没有提供什么样式，它们只返回指向样式的ResourceKey 对象。</em></p>
<p>  **ListBox控件已经提供了强大的数据模板和样式化功能（所有继承自ItemsControl的类都是如此）。**有雄心的开发人员个通过提供不同的数据模板、布局面板已经控件模板，成型实现ListView控件的格式化外观。</p>
<p>  事实上，为创建能够自定义的具有多列的列表，不需要使用具有 View 属性的 ListView 类。实际上，为 ListBox 控件使用模板和样式化功能可获得相同的效果。但 View 属性是一个很有用的抽象概念。<code>下面列出它的一些优点</code>:</p>
<ul>
<li><strong>可重用的视图</strong>。ListView控件将所有特定于视图的细节分离到一个对象中，这样便于创建不依赖于数据并且个用于多个列表的视图。</li>
<li><strong>多视图</strong>。将ListView控件和View对象分离开来，还使得对同一列表切换多个视图变得更容易（<em>例如，在Windows资源管理器中，使用这种技术显示文件和文件夹的不同查看方式</em>）。个通过动态改变模板和样式男构建相同的特性，但只使用一个封装了所有视图细节的对象更容易。</li>
<li><strong>更好的组织</strong>。视图对象封装了两个样式：一个用于ListView根控件；另一个用于列表中的单个项。因为这些样式封装在一起，所以很明显这两部分时相关联的，个共享特定的细节并且相互依赖。<em>例如，对于基于列的ListView控件这是非常合理的，因为需要保持列标题和列数据相互对齐</em></li>
</ul>
<p>  使用这种模型，可预先创建大量非常有用的、所有开发人员都可以使用的视图。但WPF目前只提供了视图对象 GirdView。尽管 GridView 对于创建多列列表非常有用，但如果有其他需求的话，就需要创建自定义视图。接下来的几节将介绍这两部分内容。</p>
<div class="note info flat"><p>如果希望实现可配置的数据显示，并希望用户能够选用网格风格的视图，那么 GridView 控件是很好的选择。但如果希望网格支持高级的样式化、选择以及编辑功能，就需要使用 DataGrid 控件。</p>
</div>
<h2 id="使用gridview创建列">使用GridView创建列</h2>
<p>  GridView类继承自ViewBase类，表示具有多列的列表视图。通过为<code>GridView.Columns</code>集合添加<code>GridViewColumn</code>对象可定义这些列。</p>
<p>  GridView 和 GridViewColumn 都提供了一些有用的方法，可使用这些方法定制列表的显示外观。为创建最简单、最直观的列表(很像 Windows 资源管理器中的详细信息视图)，只需要为每个 GridViewColumn 对象设置两个属性:Header 和 DisplayMemberBinding。Header 属性提供放在列顶部的文本，而 DisplayMemberBinding属性包含一个绑定，该绑定从每个数据项提取希望显示的信息。</p>
<blockquote>
<p>下面具有三列有关产品的信息</p>
</blockquote>
<img src= "/img/loading.gif" data-lazy-src="https://cnlicm-blog-image.oss-cn-shenzhen.aliyuncs.com/img/20240805195349.png"/>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">Grid</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">ListView</span></span></span><br><span class="line"><span class="tag">        <span class="attr">ItemsSource</span>=<span class="string">&quot;&#123;Binding Products&#125;&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">Margin</span>=<span class="string">&quot;5&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">Name</span>=<span class="string">&quot;LstProducts&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">ListView.View</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">GridView</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">GridView.Columns</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">GridViewColumn</span> <span class="attr">DisplayMemberBinding</span>=<span class="string">&quot;&#123;Binding ModelName&#125;&quot;</span> <span class="attr">Header</span>=<span class="string">&quot;Name&quot;</span> /&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">GridViewColumn</span> <span class="attr">DisplayMemberBinding</span>=<span class="string">&quot;&#123;Binding ModelNumber&#125;&quot;</span> <span class="attr">Header</span>=<span class="string">&quot;Number&quot;</span> /&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">GridViewColumn</span> <span class="attr">DisplayMemberBinding</span>=<span class="string">&quot;&#123;Binding UnitCost, StringFormat=&#123;&#125;&#123;0:C&#125;&#125;&quot;</span> <span class="attr">Header</span>=<span class="string">&quot;Price&quot;</span> /&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">GridView.Columns</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">GridView</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">ListView.View</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">ListView</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">Grid</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>  这个示例有几个非常重要的地方需要注意。首先，所有列都没有硬编码尺寸。GridView 视图只是将列的尺寸设置得足够大以适应最宽的可见项(或列标题，如果它更宽的话)，在 WPF 的流式布局中，这种设计是非常合理的(当然，如果具有非常大的列，这也会带来一定的麻烦。对于这种情况，可选择将文本封装起来，如后面的“2.单元格模板”部分所述)。</p>
<p>  <strong>此外，还需要注意如何使用功能完整的绑定表达式设置<code>DisplayMemberBinding</code>属性。</strong></p>
<h3 id="改变列的尺寸">改变列的尺寸</h3>
<p>  最初，GridView视图使每列足够宽以适应最大的可见值。然而，可通过单击和拖动列标题的边缘，很容易地改变任意列的尺寸。也可双击列标题的边缘，强制GridViewColumn 对象根据当前的可见内容改变自身的大小。例如，如果向下滚动列表，就会发现一个被截断的项，因为它比当前列更宽。只要双击正确的列标题边缘，这个列就会自动地扩展自己以适应内容。</p>
<blockquote>
<p>为更精确地控制列的尺寸，当声明列时个设置特定宽度：</p>
</blockquote>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">GridViewColumn</span> <span class="attr">Width</span>=<span class="string">&quot;300&quot;</span> <span class="attr">...</span>/&gt;</span></span><br></pre></td></tr></table></figure>
<p>  这只是确定了列的初始宽度，不会阻止用户使用上面介绍的其他技术重新改变列的尺寸。但 GridViewColumn 类没有定义诸如 MaxWidth与 MinWidth 的属性，所以无法约束如何改变列的尺寸。<strong>如果希望完全禁止改变列的尺寸，唯一的选择是为GridViewColumn 的标题提供新模板。</strong></p>
<h3 id="单元格模板">单元格模板</h3>
<p>  为在单元格中显示数据，<code>GridViewColumn.DisplayMemberBinding</code>属性不是唯一的选择。另一个选择是使用<code>CellTemplate</code>属性，该属性使用数据模板。除了只能应用于一列之外，它与之前学过的数据模板十分相似。如果很耐心的话，也可为每一列都提供数据模板。</p>
<p>  当自定义<code>GridView</code>视图，单元格模板是关键的一部分，它的一个功能时允许文本换行。通常，列中的文本被封装到单行的<em>TextBlock</em>元素中。然而，可很容易地使用自己设计的数据模板改变这个细节：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">GridViewColumn</span> <span class="attr">Header</span>=<span class="string">&quot;Description&quot;</span> <span class="attr">Width</span>=<span class="string">&quot;300&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">GridViewColumn.CellTemplate</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">DataTemplate</span> <span class="attr">DataType</span>=<span class="string">&quot;&#123;x:Type models:Product&#125;&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">TextBlock</span> <span class="attr">Text</span>=<span class="string">&quot;&#123;Binding Description&#125;&quot;</span> <span class="attr">TextWrapping</span>=<span class="string">&quot;Wrap&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">DataTemplate</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">GridViewColumn.CellTemplate</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">GridViewColumn</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>  注意，为了能够得到换行效果，需要使用 Width 属性限制列宽。如果用户改变了列的尺寸文本会重新换行以适应新的宽度。您可能不希望限制 TextBlock 的宽度，因为这会使文本被限制为特定的尺寸，而不管列变得多宽或多窄。</p>
<div class="note info flat"><p>  如果能够创建使用 DisplayMemberBinding属性的数据模板，将是非常有用的。这样一来，可使用 DisplayMemberBinding 提取所需的特定属性，并使用 CellTemplate 属性将内容格式化成合适的可视化表示形式。但这是不可能实现的。<strong>如果同时设置了DisplayMember和 CellTemplate 属性，GridViewColumn 就会使用 DisplayMember 属性为单元格设置内容并完全忽略模板。</strong></p>
</div>
<blockquote>
<p>数据模板并不局限于只能使用 TextBlock 的属性。也可使用数据模板提供完全不同的元素。例如，下面的列使用数据模板显示图像</p>
</blockquote>
<img src= "/img/loading.gif" data-lazy-src="https://cnlicm-blog-image.oss-cn-shenzhen.aliyuncs.com/img/20240805201459.png"/>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">GridViewColumn</span> <span class="attr">Header</span>=<span class="string">&quot;Picture&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">GridViewColumn.CellTemplate</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">DataTemplate</span> <span class="attr">DataType</span>=<span class="string">&quot;&#123;x:Type models:Product&#125;&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">TextBlock</span> <span class="attr">Text</span>=<span class="string">&quot;&#123;Binding ProductImagePath, Converter=&#123;converters:ImagePathConverter&#125;&#125;&quot;</span> <span class="attr">TextWrapping</span>=<span class="string">&quot;Wrap&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">DataTemplate</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">GridViewColumn.CellTemplate</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">GridViewColumn</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>  可改变模板，从而为不同的数据项应用不同的模板。为此，需要创建模板选择器，根据位于特定位置的数据对象的属性选择恰当的模板。为使用该特性，需要创建自己的选择器，并使用它设置 GridViewColumn.CelTemplateSelector 属性。</p>
<p>  如果希望用自己的内容填充列标题，但不希望为每列单独指定内容，可使用GridViewColumn.HeaderTemplate 属性定义一个数据模板。这个数据模板可以绑定到在GridViewColumn.Header属性中指定的任何对象，并相应地加以显示。</p>
<h3 id="创建自定义视图">创建自定义视图</h3>
<p>  如果GridView视图不能满足需要，个创建自己的视图以扩展<code>ListView</code>控件的功能。不过，这并不容易实现。</p>
<p>  <em>为理解这一点，需要理解有关视图工作原理的更多细节。视图通过重写两个受保护的属性进行工作:DefaultStyleKey和 ItemContainerDefaultStyleKey。这两个属性都返回名为ResourceKey的特殊对象，该对象指向在 XAML中定义的样式。DefaultStyleKey属性指向将被用于配置整个 ListView 控件的样式,而 ItemContainer.DefaultStyleKey属性指向将被用于配置 ListView 控件中每个 ListViewItem 元素的样式。尽管这些样式可修改任意属性，但它们通常通过替换用于ListView 控件:的 ControlTemplate 以及用于每个 ListViewItem 元素的 DataTemplate 进行工作。</em></p>
<p>  这正是出现问题的地方。用于显示项的 DataTemplate 是在 XAML, 标记中定义的。假设希望创建一个 ListView 控件，为每个项显示平铺的图像。使用数据模板十分容易——只需要将Image 元素的 Source 属性绑定到数据对象的合适属性即可。但如何知道用户会提供哪个数据对象呢? <strong>如果将属性名称硬编码为视图的一部分，就会使视图失去用处，从而会限制在其他情况下重用自定义的视图。另一种选择是——强制用户提供 DataTemplate–这意味着不能在视图中封装太多功能，这样重用视图也就失去了意义。</strong></p>
<div class="note warning flat"><p>在开始创建自定义视图之前，首先需要考虑一下:通过为 ListBox 控件简单使用合适的DataTemplate，或者结合使用 ListView与 GridView，是否能够得到同样的结果。</p>
</div>
<p><em>如果通过重新样式化 ListView 控件(甚至 ListBox 控件)已经能够得到所有需要的功能，那么为什么还要设计自定义视图呢?主要原因是希望列表能够动态地改变视图。例如，可能希望根据用户的选择以不同模式查看产品列表。可通过动态地切换不同的 DataTemplate 对象实现这种效果(这也是合理的方法)，但视图通常需要同时改变 ListViewItem的 DataTemplate,以及 ListView控件自身的布局或整个外观。视图有助于澄清源代码中这些细节之间的关系。</em></p>
<p>  下面的示例显示了如何创建能无缝地从一个视图切换到另一个视图的网格控件。该网格以熟悉的独立列视图开始，但还支持两个平铺显示图像的视图</p>
<h4 id="视图类">视图类</h4>
<p>  <strong>构建这个示例的第一步是设计代表自定义视图的类。该类必须继承自ViewBase 类。此外，为提供样式引用，自定义视图类通常会(但并非总是如此)重写 DefaultStyleKey和 ItemContainerDefaultStyleKey 属性。</strong></p>
<p>  在这里示例中，视图被命名为<code>TileView</code>，因为它的重要特征是在提供的空间中平铺显示数据项。<code>TileView</code>类使用<code>WrapPanel</code>面板布局所包含的<code>ListViewItem</code>对象。这个视图没有被命名为<em>ImageView</em>，这是因为没有硬编码平铺显示的内容，并且完全可以不包含图像。相反，平铺的内容时由开发人员在使用<code>TileView</code>视图时提供的模板定义的。</p>
<p>  <strong>TileView 类应用了两个样式:TileView(用于 ListView)和 TileViewItem(用于 ListViewItem)。此外，TileView 类还定义了 ItemTemplate 属性，使得使用 TileView 类的开发人员能够提供正确的数据模板。然后这个模板被插入到每个 ListViewltem 元素的内部,用于创建平铺显示的内容。</strong></p>
<img src= "/img/loading.gif" data-lazy-src="https://cnlicm-blog-image.oss-cn-shenzhen.aliyuncs.com/img/WpfApp_Yka5P6pbNH.gif"/>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">TileView</span> : <span class="title">ViewBase</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">private</span> DataTemplate _itemTemplate;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> DataTemplate ItemTemplate</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">get</span> =&gt; _itemTemplate;</span><br><span class="line">        <span class="keyword">set</span> =&gt; _itemTemplate = <span class="keyword">value</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">override</span> <span class="built_in">object</span> DefaultStyleKey</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">get</span> &#123; <span class="keyword">return</span> <span class="keyword">new</span> ComponentResourceKey(GetType(), <span class="string">&quot;TileView&quot;</span>); &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">override</span> <span class="built_in">object</span> ItemContainerDefaultStyleKey</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">get</span> &#123; <span class="keyword">return</span> <span class="keyword">new</span> ComponentResourceKey(GetType(), <span class="string">&quot;TileViewItem&quot;</span>); &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>  <em>正如您可能看到的，TileView类没有执行很多工作。它只提供了一个ComponentResourceKey弓用，指向正确的样式。在第10章当第一次分析如何从 DLL程序集中检索共享资源时，已学习过ComponentResourceKey.</em></p>
<p>  **ComponentResourceKey封装了两部分信息:拥有样式的类的类型，以及标识资源的描述性的 ResourceId 字符串。在这个示例中，类型很明显是针对这两个资源键的 TileView类。描述性的 Resourceld 名称不很重要,但必须保持一致,在这个示例中,默认的样式键被命名为 TileView而用于每个 ListViewltem 元素的样式被命名为 TileViewItem。**接下来的内容将深入分析这些样式，并会介绍如何定义它们。</p>
<h4 id="视图样式">视图样式</h4>
<p>  <strong>为让 <code>TileView</code> 视图能够工作，WPF 需要能够找到希望使用的样式。确保能够自动获得样式的技巧是创建名为 <code>generic.xaml</code>的资源字典。这个资源字典必须被放在项目文件夹下的 <code>Themes </code>子文件夹中。WPF 使用 generic.xaml 文件获取关联到某个类的默认样式</strong></p>
<p>  在这个示例中，generic.xaml 文件定义的样式被关联到 TileView 类。<strong>为在样式和 TileView类之间设置关联，需要在 generic.xaml 资源字典中为样式设置正确的键。<code>不能使用普通的字符串键,WPF 期望设置的键是一个 ComponentResourceKey对象,并且这个 ComponentResourceKey对象需要与 TileView类中的 DefaultStyleKey和 ItemContainerDefaultStyleKey属性返回的信息相匹配</code></strong></p>
<blockquote>
<p>下面是包含正确键的<code>generic.xaml</code>资源字典的基本结构</p>
</blockquote>
<p>  正如您可能看到的，为每个样式设置的键都与 TileView 类提供的信息相匹配。此外，样式还设置了 TargetType 属性(指示样式会修改哪些元素)和 BasedOn 属性(指示继承 ListBox 控件和ListBoxltem 元素使用的更基本的样式)。这会节省一些工作，并使您能集中精力使用自定义的设置扩展这些样式。</p>
<p>  因为这两个样式都与 TileView 类关联到一起，所以无论何时将 View 属性设置为 TileView 对象，它们都将被用于配置 ListView 控件。如果正在使用不同的视图对象，将会忽略这些样式。这正是所希望的 ListView控件的工作方式,从而每当改变 View属性时都会无缝地重新配置ListView控件。</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">ResourceDictionary</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns</span>=<span class="string">&quot;http://schemas.microsoft.com/winfx/2006/xaml/presentation&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:customViews</span>=<span class="string">&quot;clr-namespace:WpfApp.CustomViews&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:x</span>=<span class="string">&quot;http://schemas.microsoft.com/winfx/2006/xaml&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">Style</span></span></span><br><span class="line"><span class="tag">        <span class="attr">BasedOn</span>=<span class="string">&quot;&#123;StaticResource &#123;x:Type ListBox&#125;&#125;&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">TargetType</span>=<span class="string">&quot;&#123;x:Type ListView&#125;&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">x:Key</span>=<span class="string">&quot;&#123;ComponentResourceKey TypeInTargetAssembly=&#123;x:Type customViews:TileView&#125;,</span></span></span><br><span class="line"><span class="string"><span class="tag">                                     ResourceId=TileView&#125;&quot;</span>&gt;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">Setter</span> <span class="attr">Property</span>=<span class="string">&quot;BorderBrush&quot;</span> <span class="attr">Value</span>=<span class="string">&quot;Black&quot;</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">Setter</span> <span class="attr">Property</span>=<span class="string">&quot;BorderThickness&quot;</span> <span class="attr">Value</span>=<span class="string">&quot;0.5&quot;</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">Setter</span> <span class="attr">Property</span>=<span class="string">&quot;Grid.IsSharedSizeScope&quot;</span> <span class="attr">Value</span>=<span class="string">&quot;True&quot;</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">Setter</span> <span class="attr">Property</span>=<span class="string">&quot;ItemsPanel&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">Setter.Value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                <span class="tag">&lt;<span class="name">ItemsPanelTemplate</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                    <span class="tag">&lt;<span class="name">WrapPanel</span> <span class="attr">Width</span>=<span class="string">&quot;&#123;Binding (FrameworkElement.ActualWidth), RelativeSource=&#123;RelativeSource FindAncestor, AncestorType=ScrollContentPresenter&#125;&#125;&quot;</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">                <span class="tag">&lt;/<span class="name">ItemsPanelTemplate</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;/<span class="name">Setter.Value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">Setter</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    </span><span class="tag">&lt;/<span class="name">Style</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">Style</span></span></span><br><span class="line"><span class="tag">        <span class="attr">BasedOn</span>=<span class="string">&quot;&#123;StaticResource &#123;x:Type ListBoxItem&#125;&#125;&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">TargetType</span>=<span class="string">&quot;&#123;x:Type ListViewItem&#125;&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">x:Key</span>=<span class="string">&quot;&#123;ComponentResourceKey TypeInTargetAssembly=&#123;x:Type customViews:TileView&#125;,</span></span></span><br><span class="line"><span class="string"><span class="tag">                                     ResourceId=TileViewItem&#125;&quot;</span>&gt;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">Setter</span> <span class="attr">Property</span>=<span class="string">&quot;Padding&quot;</span> <span class="attr">Value</span>=<span class="string">&quot;3&quot;</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">Setter</span> <span class="attr">Property</span>=<span class="string">&quot;HorizontalContentAlignment&quot;</span> <span class="attr">Value</span>=<span class="string">&quot;Center&quot;</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">Setter</span> <span class="attr">Property</span>=<span class="string">&quot;ContentTemplate&quot;</span> <span class="attr">Value</span>=<span class="string">&quot;&#123;Binding Path=View.ItemTemplate, RelativeSource=&#123;RelativeSource FindAncestor, AncestorType=&#123;x:Type ListView&#125;&#125;&#125;&quot;</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">    </span><span class="tag">&lt;/<span class="name">Style</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">ResourceDictionary</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>  应用于ListView控件的TileView样式有如下三个变化：</p>
<ul>
<li>在<code>ListView</code>控件周围添加了稍微不同的边框</li>
<li>将<code>Grid.IsSharedSizeScope</code>附加属性设置为true。从而如果使用Grid布局容器，可以使不同的列表项使用共享的列或行。在这个示例中，这个设置确保在详细信息平铺视图中每个项都具有相同的范围</li>
<li>将<code>ItemsPanel</code>属性成<em>StackPanel</em>面板改为<code>WrapPanel</code>面板，从而实现平铺行为。<code>WrapPanel</code>面板的宽度被设置为与<code>ListView</code>控件的开盾相匹配。</li>
</ul>
<p>  <strong>请记住，为了确保最大的灵活性，将 TileView 类设计为使用由开发人员提供的数据模板。为应用这个模板，TileView 样式需要检索 TileView 对象(使用 ListView.View 属性)，然后从TileView.ItemTemplate 属性中提取数据模板。这个步骤使用绑定表达式来查找元素树(使用FindAncestorRelativeSource 模式)，直至找到所属的 ListView 控件。</strong></p>
<h4 id="使用listview控件">使用ListView控件</h4>
<p>  一旦构建好视图类和支持样式，就为在<code>ListView</code>控件中使用它们做好了准备。为使用自定义视图，只需将<code>ListView.View</code>属性设置为自定义视图对象的实例，如下所示：</p>
<div class="tabs" id="usetileview"><ul class="nav-tabs"><button type="button" class="tab  active" data-href="usetileview-1">MainWindow.xaml</button><button type="button" class="tab " data-href="usetileview-2">MainWindow.xaml.cs</button></ul><div class="tab-contents"><div class="tab-item-content active" id="usetileview-1"><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">Window</span></span></span><br><span class="line"><span class="tag">    <span class="attr">Height</span>=<span class="string">&quot;375&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">Title</span>=<span class="string">&quot;MainWindow&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">Width</span>=<span class="string">&quot;450&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">x:Class</span>=<span class="string">&quot;WpfApp.MainWindow&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns</span>=<span class="string">&quot;http://schemas.microsoft.com/winfx/2006/xaml/presentation&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:converters</span>=<span class="string">&quot;clr-namespace:WpfApp.Converters&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:customViews</span>=<span class="string">&quot;clr-namespace:WpfApp.CustomViews&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:local</span>=<span class="string">&quot;clr-namespace:WpfApp.ViewModels&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:x</span>=<span class="string">&quot;http://schemas.microsoft.com/winfx/2006/xaml&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">Window.DataContext</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">local:MainWindowViewModel</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">Window.DataContext</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">Window.Resources</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">GridView</span> <span class="attr">x:Key</span>=<span class="string">&quot;GridView&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">GridView.Columns</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">GridViewColumn</span> <span class="attr">DisplayMemberBinding</span>=<span class="string">&quot;&#123;Binding ModelName&#125;&quot;</span> <span class="attr">Header</span>=<span class="string">&quot;Name&quot;</span> /&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">GridViewColumn</span> <span class="attr">DisplayMemberBinding</span>=<span class="string">&quot;&#123;Binding ModelNumber&#125;&quot;</span> <span class="attr">Header</span>=<span class="string">&quot;Model&quot;</span> /&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">GridViewColumn</span> <span class="attr">DisplayMemberBinding</span>=<span class="string">&quot;&#123;Binding UnitCost&#125;&quot;</span> <span class="attr">Header</span>=<span class="string">&quot;Price&quot;</span> /&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">GridView.Columns</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">GridView</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">customViews:TileView</span> <span class="attr">x:Key</span>=<span class="string">&quot;ImageView&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">customViews:TileView.ItemTemplate</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">DataTemplate</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">StackPanel</span> <span class="attr">VerticalAlignment</span>=<span class="string">&quot;Top&quot;</span> <span class="attr">Width</span>=<span class="string">&quot;150&quot;</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">Image</span> <span class="attr">Source</span>=<span class="string">&quot;&#123;Binding ProductImagePath, Converter=&#123;converters:ImagePathConverter&#125;&#125;&quot;</span> /&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">TextBlock</span></span></span><br><span class="line"><span class="tag">                            <span class="attr">HorizontalAlignment</span>=<span class="string">&quot;Center&quot;</span></span></span><br><span class="line"><span class="tag">                            <span class="attr">Text</span>=<span class="string">&quot;&#123;Binding ModelName&#125;&quot;</span></span></span><br><span class="line"><span class="tag">                            <span class="attr">TextWrapping</span>=<span class="string">&quot;Wrap&quot;</span> /&gt;</span></span><br><span class="line">                    <span class="tag">&lt;/<span class="name">StackPanel</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">DataTemplate</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">customViews:TileView.ItemTemplate</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">customViews:TileView</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">customViews:TileView</span> <span class="attr">x:Key</span>=<span class="string">&quot;ImageDetailView&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">customViews:TileView.ItemTemplate</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">DataTemplate</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">Grid</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">Grid.ColumnDefinitions</span>&gt;</span></span><br><span class="line">                            <span class="tag">&lt;<span class="name">ColumnDefinition</span> <span class="attr">Width</span>=<span class="string">&quot;Auto&quot;</span> /&gt;</span></span><br><span class="line">                            <span class="tag">&lt;<span class="name">ColumnDefinition</span> <span class="attr">SharedSizeGroup</span>=<span class="string">&quot;Col2&quot;</span> <span class="attr">Width</span>=<span class="string">&quot;Auto&quot;</span> /&gt;</span></span><br><span class="line">                        <span class="tag">&lt;/<span class="name">Grid.ColumnDefinitions</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">Image</span></span></span><br><span class="line"><span class="tag">                            <span class="attr">Margin</span>=<span class="string">&quot;5&quot;</span></span></span><br><span class="line"><span class="tag">                            <span class="attr">Source</span>=<span class="string">&quot;&#123;Binding ProductImagePath, Converter=&#123;converters:ImagePathConverter&#125;&#125;&quot;</span></span></span><br><span class="line"><span class="tag">                            <span class="attr">Width</span>=<span class="string">&quot;100&quot;</span> /&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">StackPanel</span> <span class="attr">Grid.Column</span>=<span class="string">&quot;1&quot;</span> <span class="attr">VerticalAlignment</span>=<span class="string">&quot;Center&quot;</span>&gt;</span></span><br><span class="line">                            <span class="tag">&lt;<span class="name">TextBlock</span> <span class="attr">FontWeight</span>=<span class="string">&quot;Bold&quot;</span> <span class="attr">Text</span>=<span class="string">&quot;&#123;Binding ModelName&#125;&quot;</span> /&gt;</span></span><br><span class="line">                            <span class="tag">&lt;<span class="name">TextBlock</span> <span class="attr">Text</span>=<span class="string">&quot;&#123;Binding ModelNumber&#125;&quot;</span> /&gt;</span></span><br><span class="line">                            <span class="tag">&lt;<span class="name">TextBlock</span> <span class="attr">Text</span>=<span class="string">&quot;&#123;Binding UnitCost, StringFormat=&#123;&#125;&#123;0:C&#125;&#125;&quot;</span> /&gt;</span></span><br><span class="line">                        <span class="tag">&lt;/<span class="name">StackPanel</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;/<span class="name">Grid</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">DataTemplate</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">customViews:TileView.ItemTemplate</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">customViews:TileView</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;/<span class="name">Window.Resources</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">Grid</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">Grid.RowDefinitions</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">RowDefinition</span> <span class="attr">Height</span>=<span class="string">&quot;*&quot;</span> /&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">RowDefinition</span> <span class="attr">Height</span>=<span class="string">&quot;Auto&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">Grid.RowDefinitions</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">ListView</span></span></span><br><span class="line"><span class="tag">            <span class="attr">ItemsSource</span>=<span class="string">&quot;&#123;Binding Products&#125;&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">Margin</span>=<span class="string">&quot;5&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">Name</span>=<span class="string">&quot;LstProducts&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">View</span>=<span class="string">&quot;&#123;StaticResource GridView&#125;&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">StackPanel</span> <span class="attr">Grid.Row</span>=<span class="string">&quot;1&quot;</span> <span class="attr">Orientation</span>=<span class="string">&quot;Horizontal&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">TextBlock</span></span></span><br><span class="line"><span class="tag">                <span class="attr">Margin</span>=<span class="string">&quot;10,0&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">Text</span>=<span class="string">&quot;Choose View:&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">VerticalAlignment</span>=<span class="string">&quot;Center&quot;</span> /&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">ComboBox</span></span></span><br><span class="line"><span class="tag">                <span class="attr">SelectedIndex</span>=<span class="string">&quot;0&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">SelectionChanged</span>=<span class="string">&quot;LstView_OnSelectionChanged&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">Width</span>=<span class="string">&quot;120&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">x:Name</span>=<span class="string">&quot;LstView&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">ComboBoxItem</span>&gt;</span>GridView<span class="tag">&lt;/<span class="name">ComboBoxItem</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">ComboBoxItem</span>&gt;</span>ImageView<span class="tag">&lt;/<span class="name">ComboBoxItem</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">ComboBoxItem</span>&gt;</span>ImageDetailView<span class="tag">&lt;/<span class="name">ComboBoxItem</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">ComboBox</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">StackPanel</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">Grid</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">Window</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure></div><div class="tab-item-content" id="usetileview-2"><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">partial</span> <span class="keyword">class</span> <span class="title">MainWindow</span> : <span class="title">Window</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">MainWindow</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        InitializeComponent();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">LstView_OnSelectionChanged</span>(<span class="params"><span class="built_in">object</span> sender, SelectionChangedEventArgs e</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">var</span> selectedItem =  (ComboBoxItem)LstView.SelectedItem;</span><br><span class="line">        LstProducts.View = (ViewBase)<span class="keyword">this</span>.FindResource(selectedItem.Content);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div></div><div class="tab-to-top"><button type="button" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div>
<p>  毫无疑问，为生成具有多个视图选项的 ListView控件，需要的代码比想象得多。然而，现在已经完成了该例，并且可以很容易地(以 TileView 类为基础)创建其他提供不同数据项模板的视图，从而提供更多的视图选项。</p>
<h4 id="为视图传递信息">为视图传递信息</h4>
<p>  通过添加当使用视图时使用者可设置的属性，可增加视图类的灵活性。然后样式可以使用数据绑定检索这些数值，并使用它们配置 Setter对象</p>
<p>  <em>例如，现在 TileView 类使用不是很吸引人的蓝色来突出显示被选中的项。这个效果更加令人惊奇，因为它使显示产品细节的黑色文本更难以阅读。可通过使用自定义的具有适当触发器的自定义控件模板可以纠正这个问题。</em></p>
<p>  但并非硬编码一套更好的颜色，让视图使用者指定这个细节更合理。为让<code>TileView</code>类实现这个目标，需要添加与下面类似的一组属性：</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">TileView</span> : <span class="title">ViewBase</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">private</span> Brush _selectedBackground = Brushes.Transparent;</span><br><span class="line">    <span class="keyword">public</span> Brush SelectedBackground</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">get</span> =&gt; _selectedBackground;</span><br><span class="line">        <span class="keyword">set</span> =&gt; _selectedBackground = <span class="keyword">value</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Brush _selectedBorderBrush = Brushes.Transparent;</span><br><span class="line">    <span class="keyword">public</span> Brush SelectedBorderBrush</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">get</span> =&gt; _selectedBorderBrush;</span><br><span class="line">        <span class="keyword">set</span> =&gt; _selectedBorderBrush = <span class="keyword">value</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>  当实例化视图对象时，可以设置这些细节了：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">customViews:TileView</span></span></span><br><span class="line"><span class="tag">            <span class="attr">SelectedBackground</span>=<span class="string">&quot;LightSteelBlue&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">SelectedBorderBrush</span>=<span class="string">&quot;Aqua&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">x:Key</span>=<span class="string">&quot;ImageDetailView&quot;</span>&gt;</span></span><br><span class="line">...</span><br><span class="line"><span class="tag">&lt;/<span class="name">customViews.TileView</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>  最后一步时在<code>ListViewItem</code>样式中使用这些颜色。为此，需要添加替换<code>ControlTemplate</code>的<code>Setter</code>对象。在这个示例中，结合使用<code>ContentPresenter</code>元素和简单的圆角边框。当项被选中时，会引发触发器并应用新的边框和背景色：</p>
<img src= "/img/loading.gif" data-lazy-src="https://cnlicm-blog-image.oss-cn-shenzhen.aliyuncs.com/img/20240805215129.png"/>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">Style</span></span></span><br><span class="line"><span class="tag">       <span class="attr">BasedOn</span>=<span class="string">&quot;&#123;StaticResource &#123;x:Type ListBoxItem&#125;&#125;&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">TargetType</span>=<span class="string">&quot;&#123;x:Type ListViewItem&#125;&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">x:Key</span>=<span class="string">&quot;&#123;ComponentResourceKey TypeInTargetAssembly=&#123;x:Type customViews:TileView&#125;,</span></span></span><br><span class="line"><span class="string"><span class="tag">                                    ResourceId=TileViewItem&#125;&quot;</span>&gt;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">       <span class="tag">&lt;<span class="name">Setter</span> <span class="attr">Property</span>=<span class="string">&quot;Padding&quot;</span> <span class="attr">Value</span>=<span class="string">&quot;3&quot;</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">       <span class="tag">&lt;<span class="name">Setter</span> <span class="attr">Property</span>=<span class="string">&quot;HorizontalContentAlignment&quot;</span> <span class="attr">Value</span>=<span class="string">&quot;Center&quot;</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">       <span class="tag">&lt;<span class="name">Setter</span> <span class="attr">Property</span>=<span class="string">&quot;ContentTemplate&quot;</span> <span class="attr">Value</span>=<span class="string">&quot;&#123;Binding Path=View.ItemTemplate, RelativeSource=&#123;RelativeSource FindAncestor, AncestorType=&#123;x:Type ListView&#125;&#125;&#125;&quot;</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">       <span class="tag">&lt;<span class="name">Setter</span> <span class="attr">Property</span>=<span class="string">&quot;Template&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">           <span class="tag">&lt;<span class="name">Setter.Value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">               <span class="tag">&lt;<span class="name">ControlTemplate</span> <span class="attr">TargetType</span>=<span class="string">&quot;&#123;x:Type ListBoxItem&#125;&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                   <span class="tag">&lt;<span class="name">Border</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">                       <span class="attr">BorderThickness</span>=<span class="string">&quot;1&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">                       <span class="attr">CornerRadius</span>=<span class="string">&quot;3&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">                       <span class="attr">x:Name</span>=<span class="string">&quot;border&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                       <span class="tag">&lt;<span class="name">ContentPresenter</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">                   <span class="tag">&lt;/<span class="name">Border</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                   <span class="tag">&lt;<span class="name">ControlTemplate.Triggers</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                       <span class="tag">&lt;<span class="name">Trigger</span> <span class="attr">Property</span>=<span class="string">&quot;IsSelected&quot;</span> <span class="attr">Value</span>=<span class="string">&quot;True&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                           <span class="tag">&lt;<span class="name">Setter</span> <span class="attr">Property</span>=<span class="string">&quot;BorderBrush&quot;</span> <span class="attr">TargetName</span>=<span class="string">&quot;border&quot;</span> <span class="attr">Value</span>=<span class="string">&quot;&#123;Binding View.SelectedBorderBrush, RelativeSource=&#123;RelativeSource FindAncestor, AncestorType=&#123;x:Type ListView&#125;&#125;&#125;&quot;</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">                           <span class="tag">&lt;<span class="name">Setter</span> <span class="attr">Property</span>=<span class="string">&quot;Background&quot;</span> <span class="attr">TargetName</span>=<span class="string">&quot;border&quot;</span> <span class="attr">Value</span>=<span class="string">&quot;&#123;Binding View.SelectedBackground, RelativeSource=&#123;RelativeSource FindAncestor, AncestorType=&#123;x:Type ListView&#125;&#125;&#125;&quot;</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">                       <span class="tag">&lt;/<span class="name">Trigger</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                   <span class="tag">&lt;/<span class="name">ControlTemplate.Triggers</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">               <span class="tag">&lt;/<span class="name">ControlTemplate</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">           <span class="tag">&lt;/<span class="name">Setter.Value</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">       <span class="tag">&lt;/<span class="name">Setter</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">   </span><span class="tag">&lt;/<span class="name">Style</span>&gt;</span></span><br></pre></td></tr></table></figure>
<div class="note warning flat"><p>但这种向视图传递信息的技术仍然不能帮助用户实现真正通用的视图，这是因为无法根据这一信息修改数据模板。</p>
</div>
<h2 id="treeview控件">TreeView控件</h2>
<p>  <code>TreeView</code>控件时最重要的<em>Windows</em>控件之一，它被集成到Windows资源管理器乃至.NET帮助文档库等各种元素中。WPF中实现的<code>TreeView</code>控件更时令人印象深刻，因为它完全支持数据绑定。</p>
<p>  <strong>TreeView 控件在本质上是驻留 TreeViewItem 对象的特殊 ItemsControl控件。但与 ListViewItem对象不同，TreeViewItem对象不是内容控件。相反，每个TreeViewItem 对象都是单独的ItemsControl控件，可以包含更多 TreeViewItem 对象。通过这一灵活性，可以创建更深层次的数据显示。</strong></p>
<div class="note info flat"><p>从技术角度看，TreeViewItem 类继承自 HeaderedItemsControl类，HeaderedItemsControl 类又继承自 ItemsControl 类。HeaderedItemsControl 类添加了Header 属性，该属性包含了希望为树中每个项显示的内容(通常是文本)。WPF还另外提供了两个HeaderedltemsControl类:Menultem和 ToolBar.</p>
</div>
<blockquote>
<p>下面是一个非常脚本的TreeView控件的骨架，它全部使用标记声明：</p>
</blockquote>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">TreeView</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">TreeViewItem</span> <span class="attr">Header</span>=<span class="string">&quot;Fruit&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">TreeViewItem</span> <span class="attr">Header</span>=<span class="string">&quot;🍊&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">TreeViewItem</span> <span class="attr">Header</span>=<span class="string">&quot;🍌&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">TreeViewItem</span> <span class="attr">Header</span>=<span class="string">&quot;🍉&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">TreeViewItem</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">TreeViewItem</span> <span class="attr">Header</span>=<span class="string">&quot;Vegetables&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">TreeViewItem</span> <span class="attr">Header</span>=<span class="string">&quot;🥬&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">TreeViewItem</span> <span class="attr">Header</span>=<span class="string">&quot;🥕&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">TreeViewItem</span> <span class="attr">Header</span>=<span class="string">&quot;🧅&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">TreeViewItem</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">TreeView</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>  不见得非要使用 TreeViewItem 对象构造 TreeView 控件。实际上，几乎可为 TreeView 控件添加任何元素，包括按钮、面板以及图像。然而，**如果希望显示非文本内容，最好使用TreeViewItem 封装器，并通过 TreeViewItem.Header 属性提供内容。**虽然这与直接为 TreeView控件添加非 TreeViewtem 元素得到的效果相同，但这样做将更容易管理一些特定于 TreeView 控件的细节，例如选择和展开节点。如果希望显示非 UIEement 对象，可使用具有 HeaderTemplate 或HeaderTemplateSelector 属性的数据模板设置其格式。</p>
<h3 id="创建数据绑定的treeview控件">创建数据绑定的TreeView控件</h3>
<p>  通常，不希望在标记中使用硬编码的固定信息填充<code>TreeView</code>控件。相反，将通过代码构造<code>TreeViewItem</code>对象，或使用数据绑定显示对象集合。</p>
<p>  使用数据填充TreeView控件非常简单–与任意 ItemsControl控件一样，只需要设置 ItemsSource 属性。然而,这种技术只能填充 TreeView 控件的第一层。使用TreeView 控件更有趣的方法是包含具有某种嵌套结构的层次化数据。</p>
<p>  TreeView 控件使得显示层次化数据变得更加容易，不管是使用手工编写的类还是使用ADO.NETDataSet。<strong>只需要指定正确的数据模板，数据模板指示不同层次数据之间的关系。</strong></p>
<img src= "/img/loading.gif" data-lazy-src="https://cnlicm-blog-image.oss-cn-shenzhen.aliyuncs.com/img/20240806211402.png"/>
<div class="tabs" id="treeview"><ul class="nav-tabs"><button type="button" class="tab  active" data-href="treeview-1">TreeView</button><button type="button" class="tab " data-href="treeview-2">DataSource</button></ul><div class="tab-contents"><div class="tab-item-content active" id="treeview-1"><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">TreeView</span> <span class="attr">ItemsSource</span>=<span class="string">&quot;&#123;Binding Categories&#125;&quot;</span> <span class="attr">Margin</span>=<span class="string">&quot;5&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">TreeView.ItemTemplate</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">HierarchicalDataTemplate</span> <span class="attr">ItemsSource</span>=<span class="string">&quot;&#123;Binding Children&#125;&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">TextBlock</span> <span class="attr">Text</span>=<span class="string">&quot;&#123;Binding CategoryName&#125;&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">HierarchicalDataTemplate</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">TreeView.ItemTemplate</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">TreeView</span>&gt;</span></span><br></pre></td></tr></table></figure></div><div class="tab-item-content" id="treeview-2"><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">[<span class="meta">ObservableProperty</span>] </span><br><span class="line"><span class="keyword">private</span> ObservableCollection&lt;Category&gt; _categories =</span><br><span class="line">[</span><br><span class="line">    <span class="keyword">new</span> Category(<span class="string">&quot;菜单1&quot;</span>, <span class="keyword">new</span> List&lt;Category&gt;()</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">new</span> Category(<span class="string">&quot;菜单1.1&quot;</span>),</span><br><span class="line">        <span class="keyword">new</span> Category(<span class="string">&quot;菜单1.2&quot;</span>),</span><br><span class="line">        <span class="keyword">new</span> Category(<span class="string">&quot;菜单1.3&quot;</span>),</span><br><span class="line">    &#125;),</span><br><span class="line">    <span class="keyword">new</span> Category(<span class="string">&quot;菜单2&quot;</span>, <span class="keyword">new</span> List&lt;Category&gt;()</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">new</span> Category(<span class="string">&quot;菜单2.1&quot;</span>),</span><br><span class="line">        <span class="keyword">new</span> Category(<span class="string">&quot;菜单2.2&quot;</span>),</span><br><span class="line">    &#125;)</span><br><span class="line">];</span><br></pre></td></tr></table></figure></div></div><div class="tab-to-top"><button type="button" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div>
<h3 id="即时创建节点">即时创建节点</h3>
<p>  TreeView 控件经常用于包含大量数据，这是因为TreeView 控件的显示是能够折叠的。即使用户从顶部滚动到底部，也不需要显示全部信息。完全可在 TreeView 控件中省略不显示的信息，以便降低开销(以及填充树所需的时间)。甚至更好的是，<strong>当展开每个TreeViewltem 对象时会引发 Expanded 事件，并且当关闭时会引发Collapsed事件。可通过处理这两个事件即时填充丢失的节点或丢弃不再需要的节点。这种技术被称为<code>即时创建节点</code>(iust-in-time node creation)。</strong></p>
<p>  即时创建节点可应用于从数据库提取所需数据的应用程序，但典型的例子是目录浏览应用程序。现在，大多数用户都有层次复杂的庞大硬盘驱动器。尽管可使用硬盘的目录结构填充TreeView 控件，但这个过程非常缓慢。更好的做法是首先填充部分折叠的视图，并允许用户进入到特定目录。当打开每个节点时，相应的子目录被添加到树中——这个过程几乎是瞬间完成的。</p>
<div class="tabs" id="nodecreation"><ul class="nav-tabs"><button type="button" class="tab  active" data-href="nodecreation-1">MainWindow.xaml</button><button type="button" class="tab " data-href="nodecreation-2">MainWindow.xaml.cs</button></ul><div class="tab-contents"><div class="tab-item-content active" id="nodecreation-1"><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">TreeView</span> <span class="attr">Name</span>=<span class="string">&quot;treeFileSystem&quot;</span> <span class="attr">TreeViewItem.Expanded</span>=<span class="string">&quot;TreeFileSystem_OnExpanded&quot;</span> /&gt;</span></span><br></pre></td></tr></table></figure></div><div class="tab-item-content" id="nodecreation-2"><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">partial</span> <span class="keyword">class</span> <span class="title">MainWindow</span> : <span class="title">Window</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">MainWindow</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        InitializeComponent();</span><br><span class="line">        </span><br><span class="line">        Loaded += OnLoaded;</span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">OnLoaded</span>(<span class="params"><span class="built_in">object</span> sender, RoutedEventArgs e</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">foreach</span> (<span class="keyword">var</span> drive <span class="keyword">in</span> DriveInfo.GetDrives())</span><br><span class="line">        &#123;</span><br><span class="line">            TreeViewItem item = <span class="keyword">new</span> TreeViewItem();</span><br><span class="line">            item.Tag = drive;</span><br><span class="line">            item.Header = drive.ToString();</span><br><span class="line"></span><br><span class="line">            item.Items.Add(<span class="string">&quot;*&quot;</span>);</span><br><span class="line">            treeFileSystem.Items.Add(item);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">TreeFileSystem_OnExpanded</span>(<span class="params"><span class="built_in">object</span> sender, RoutedEventArgs e</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        TreeViewItem item = (TreeViewItem)e.OriginalSource;</span><br><span class="line">        item.Items.Clear();</span><br><span class="line"></span><br><span class="line">        DirectoryInfo dir;</span><br><span class="line">        <span class="keyword">if</span> (item.Tag <span class="keyword">is</span> DriveInfo)</span><br><span class="line">        &#123;</span><br><span class="line">            DriveInfo drive = (DriveInfo)item.Tag;</span><br><span class="line">            dir = drive.RootDirectory;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            dir = (DirectoryInfo)item.Tag;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">foreach</span> (<span class="keyword">var</span> subDir <span class="keyword">in</span> dir.GetDirectories())</span><br><span class="line">            &#123;</span><br><span class="line">                TreeViewItem newItem = <span class="keyword">new</span> TreeViewItem();</span><br><span class="line">                newItem.Tag = subDir;</span><br><span class="line">                newItem.Header = subDir.ToString();</span><br><span class="line">                newItem.Items.Add(<span class="string">&quot;*&quot;</span>);</span><br><span class="line">                item.Items.Add(newItem);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">catch</span> </span><br><span class="line">        &#123;</span><br><span class="line">            </span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div></div><div class="tab-to-top"><button type="button" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div>
<p>  现在，每次展开相应的项时该代码都会执行一次刷新。此外，也可仅在第一次展开时(这时会发现占位符)才进行刷新。这虽然能减少应用程序所需要做的工作，但却会增加使用过时信息的机会。此外，可通过处理 TreeViewItem.Selected 事件，当每次选中一个项时进行刷新;或者当添加、删除或重命名文件夹时,使用组件(如 System.IO.FileSystemWatcher)等待操作系统通知。当发生变化时，FileSvstemWatcher是唯一能够确保立即更新目录树的方法，但这种做法的开销也是最大的。</p>
<h2 id="datagrid控件">DataGrid控件</h2>
<p>  顾名思义，DataGrid 控件是用来显示数据的控件，从对象集合获取信息并在具有行和单元格的网格中显示信息。每行和单独的对象相对应，并且每列和对象的某个属性相对应。</p>
<p>  DataGrid 控件添加了许多在 WPF 中处理数据所需的技能。其基于列的模型提供了显著的格式化灵活性。其选择模型允许选择一行、多行或一些单元格的组合。其编辑支持非常强大，可使用 DataGrid 控件作为简单数据和复杂数据的统一数据编辑器。</p>
<blockquote>
<p>为创建暂且应急的 DataGrid 控件，可使用自动列生成功能。为此，需要将AutoGenerateColumns 属性设置为 true(这是默认值):</p>
</blockquote>
<img src= "/img/loading.gif" data-lazy-src="https://cnlicm-blog-image.oss-cn-shenzhen.aliyuncs.com/img/20240806221406.png"/>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">DataGrid</span> <span class="attr">AutoGenerateColumns</span>=<span class="string">&quot;True&quot;</span> <span class="attr">ItemsSource</span>=<span class="string">&quot;&#123;Binding Products&#125;&quot;</span> /&gt;</span></span><br></pre></td></tr></table></figure>
<p>  <strong>为显示非字符串属性，DataGrid 控件调用 ToSting()方法。对于数字、日期以及其他简单类型，该方法效果不错。但如果对象包含更复杂的数据对象，该方法就行不通了(对于这种情况可能希望明确地定义列，从而获得绑定到子属性、使用值转换器或应用模板以获取正确显示内容的机会)。</strong></p>
<p>  下表列出了一些用于定制<code>DataGrid</code>控件基本外观的属性：</p>
<table>
<thead>
<tr>
<th>名称</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>RowBackground AlternatingRowBackground</td>
<td>用于绘制每行背景的画刷(RowBackground)，并且决定是否使用不同的背景颜色(AlternatingBackground)绘制交替行，从而更容易区分行。在默认情况下，DataGrid控件为奇数行提供白色背景，为偶数行提供淡灰色背景</td>
</tr>
<tr>
<td>ColumnHeaderHeight</td>
<td>位于DataGrid控件顶部的列表题行的高度（设备无关单位）</td>
</tr>
<tr>
<td>RowHeaderWidth</td>
<td>具有行题头的列的宽度(设备无关单位)。该列在网格的最左边，不显示任何数据该列(使用箭头)指示当前选择的行，并且(使用圈住的箭头)指示正在编辑的行</td>
</tr>
<tr>
<td>ColumnWidth</td>
<td>作为 DataGridLength 对象，用于设置每列默认宽度的尺寸改变模式</td>
</tr>
<tr>
<td>RowHeight</td>
<td>每行的高度。如果准备在 DataGrid 控件中显示多行文本或不同的内容，该设置很有用。与列不同，用户不能改变行的尺寸</td>
</tr>
<tr>
<td>GridLinesVisibility</td>
<td>确定是否显示网格线的DataGridGridlines枚举值(Horizontal、Vertical、None或All)</td>
</tr>
<tr>
<td>VerticalGridLinesBrush</td>
<td>用于绘制列之间网格线的画刷</td>
</tr>
<tr>
<td>HorizontalGridLinesBrush</td>
<td>用于绘制行之间网格线的画刷</td>
</tr>
<tr>
<td>HeadersVisibility</td>
<td>确定显示哪个题头的DataGridHeaders枚举值(Column、Row、All、None)</td>
</tr>
<tr>
<td>HorizontalScrollBarVisibility VerticalScrollBarVisibility</td>
<td>确定是否显示滚动条的ScrollBarVisility枚举值：当需要时显示(Auto)、总是显示(Visible)或总是不显示(Hidden)。这两个属性的默认值都是Auto</td>
</tr>
</tbody>
</table>
<h3 id="改变列的尺寸与重新安排列">改变列的尺寸与重新安排列</h3>
<p>  当显示自动生成的列时，<code>DataGrid</code>控件尝试根据<code>DataGrid.ColumnWidth</code>属性智能地改变每列的宽度。<br>
  为设置<code>ColumnWidth</code>属性，需要提供<code>DataGridLength</code>对象。<code>DataGridLength</code>对象能够指定确切的尺寸（使用设备无关单位），或指定特定的尺寸改变模式，从而让<code>DataGrid</code>控件自动完成一些工作。</p>
<ul>
<li><strong>DataGridLength.SizeToHeader</strong>：使列足够宽以适应它们的题头文本</li>
<li><strong>DataGridLength.SizeToCells</strong>：该模式加宽每一列以适应当前视图中最宽的值</li>
<li><strong>DataGridLength.Auto</strong>：该模式的工作方式和<code>DataGridLength.SizeToCells</code>模式类似，除了加宽每列以适应最大的显示值或列题头文本——使用其中较大值</li>
<li><strong>星号(*)</strong>:与在Grid布局面板中使用的星号(<code>*</code>)尺寸模式类似</li>
</ul>
<h3 id="定义列">定义列</h3>
<p>  使用自动生成的列，可快速创建显示所有数据的<code>DataGrid</code>控件，但放弃了一些控制能力。<em>例如，不能控制列的顺序、每列的宽度、如何格式化列中的值以及应该放在顶部的标题文本的内容。</em></p>
<p>  更强大的方法是将<code>AutoGenerateColumns</code>属性设置为false以关闭自动列生成功能。然后可使用希望的设置和指定的顺序，明确地定义希望使用的列。为此，需要使用何时的列对象填充<code>DataGrid.Columns</code>集合。</p>
<blockquote>
<p>目前，<code>DataGrid</code>控件支持几种类型的列，通过继承自<code>DataGridColumn</code>的不同类表示这些列：</p>
</blockquote>
<ul>
<li><strong>DataGridTextColumn</strong>：这种列对于大部分数据类型是标准选择。值被转换为文本，并在<code>TextBlock</code>元素中显示。当编辑行时，<code>TextBlock</code>元素被替换为标准的文本框</li>
<li><strong>DataGridCheckBoxColumn</strong>：这种列显示复选框。为Boolean(或可空Boolean)值自动使用这种列类型。通常，复选框是只读的；但当编辑行时，会变成普通的复选框</li>
<li><strong>DataGridHyperlinkColumn</strong>：这种列显示可单击的链接。如果结合使用WPF中的导航容器，如<code>Frame</code>或<code>NavigationWindow</code>，可允许用户导航到其他URI（通常是外部Web站点）</li>
<li><strong>DataGridComboBox</strong>：最初这种列看起来与<code>DataGridTextColumn</code>类似，但在编辑模式下这种列会变成下拉的<code>ComboBox</code>控件。当希望将编辑限制与允许的少部分值时，这种列时很好的选择</li>
<li><strong>DataGridTemplateColumn</strong>：这种列时到目前为止功能最强大的选择。这种列允许显示列值定义数据模板，具有在列表控件中使用模板时所具有的所有灵活性和功能。例如，可使用<code>DataGridTemplateColumn</code>显示图像数据或专门的WPF控件（如具有合法值的下拉列表或用于日期值的DataPicker控件）</li>
</ul>
<div class="note info flat"><p>当定义列时，几乎总是设置三个细节：在列顶部显示的题头文本、列的宽度以及获取数据的绑定</p>
</div>
<p>  通常使用简单字符串设置 DataGridColumn.Header 属性，但不必限制为普通文本。列题头是内容控件，可为 Header 属性提供任何内容，包括图像或具有元素组合的布局面板。</p>
<p>  <strong>DataGridColumn.Width 属性支持硬编码的值和几种自动尺寸改变模式，上一节中分析的 DataGrid.ColumnWidth 属性类似。唯一的区别是 DataGridColumn.Width 属性应用于单个列，而DataGrid.ColumnWidth 属性为整个表中所有的列设置默认宽度。当设置 DataGridColumn.Width 属性时，会覆盖 DataGrid.ColumnWidth 属性。</strong></p>
<h4 id="datagridcheckboxcolumn">DataGridCheckBoxColumn</h4>
<p>  与 DataGridTextColumn 一样，Binding 属性提取数据–对于这种情况，是用于设置内部CheckBox 元素的 IsChecked 属性的 true 或 false 值。DataGridCheckBoxColumn 还添加了 Content属性,通过该属性可在复选框旁边显示可选内容。最后,**DataGridCheckBoxColumn 提供了IsThreeState属性，该属性确定复选框是否支持未定状态以及更明显的选中和未选中状态。如果使用DataGridCheckBoxColumn 显示来自可空 Boolean 值的信息,可将 IsThreeState 属性设置为 true。**这样用户可通过单击切换到未定状态(显示为具有轻淡阴影的复选框)，以便为绑定的值返回nul。</p>
<h4 id="datagridhyperlinkcoulmn">DataGridHyperlinkCoulmn</h4>
<p>  通常，DataGridHyperlinkColumn 为导航和显示使用相同的信息。但如果愿意的话，可单独指定这些细节。为此，只需要使用 Binding属性设置URI，并使用可选的 ContentBinding 属性从绑定数据对象的不同属性获取显示的文本。</p>
<h4 id="datagridcomboboxcolumn">DataGridComboBoxColumn</h4>
<p>  DataGridComboBoxColumn虽然最初显示为普通文本，但却提供了简明流畅的编辑体验，允许用户从 ComboBox控件的可用选项列表中选择一项(实际上，用户必须从列表中进行选择，因为 ComboBox不允许直接输入文本)。</p>
<h4 id="datagridtemplatecolumn">DataGridTemplateColumn</h4>
<p>  DataGridTemplateColumn 使用数据模板，其工作方式和在以前研究的用于列表控件的数据模板特征是相同的。唯一的区别是允许在 DataGridTemplateColumn 中定义两个模板:一个用于数据显示(CellTemplate);另一个用于数据编辑(CellEditingTemplate)</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">DataGridTemplateColumn</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">DataGridTemplateColumn.CellTemplate</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">DataTemplate</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">Image</span> <span class="attr">Stream</span>=<span class="string">&quot;None&quot;</span> <span class="attr">Source</span>=<span class="string">&quot;&#123;Binding PathProductImagePath,Converter=&#123;converters:ImagePathConverter&#125;&#125;&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">DataTemplate</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">DataGridTemplateColumn.CellTemplate</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">DataGridTemplateColumn.CellTemplate</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="设置列的格式和样式">设置列的格式和样式</h3>
<p>  可使用与设置 TextBlock 元索格式相同的方式设置 DataGridTextureColumn 元素的格式，方法就是设置 Foreground、FontFamily、FontSize、FontStyle 以及 FontWeight 属性。然而,DataGridTextColumn 没有提供 TextBlock的所有属性。例如，如果希望创建显示多行文本的列,将无法设置经常使用的 Wrapping属性。对于这种情况，需要改用 ElementStyle 属性。</p>
<p>  本质上，**ElementStyle 属性用于创建应用于 DataGrid 单元格内部的元素的样式。**对于简单的 DataGridTextColumn，该元素是 TextBlock。对于 DataGridCheckBoxColumn，单元格内部的元素是复选框。对于 DataGridTemplateColumn，单元格内部的元素是在数据模板中创建的任何元素。</p>
<blockquote>
<p>下面是一个允许在列中对文本进行换行的简单样式：</p>
</blockquote>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">DataGridTextColumn</span> <span class="attr">Header</span>=<span class="string">&quot;Description&quot;</span> <span class="attr">Width</span>=<span class="string">&quot;400&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">Binding</span>=<span class="string">&quot;&#123;Binding Description&#125;&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">DataGridTextColumn.ElementStyle</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">Style</span> <span class="attr">TargetType</span>=<span class="string">&quot;TextBlock&quot;</span>&gt;</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">Setter</span> <span class="attr">Property</span>=<span class="string">&quot;TextWrapping&quot;</span> <span class="attr">Value</span>=<span class="string">&quot;Wrap&quot;</span>/&gt;</span></span></span><br><span class="line"><span class="language-xml">        </span><span class="tag">&lt;/<span class="name">Style</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">DataGridTextColumn.ElementStyle</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">DataGridTextColumn.ElementStyle</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>  可使用 EditingElementStyle 属性为编辑列时使用的元素提供样式。对于 DataGridTextColumn,编辑元素是 TextBox 控件。</p>
<p>  <strong>ElementStyle、EditingElementStyle 以及其他列属性提供了设置特定列中所有单元格的格式的方法。然而，在某些情况下，可能希望为每一列中的每个单元格应用格式化设置。完成该工作的最简单方法是为 DataGrid.RowStyle 属性配置样式。DataGrid 控件还提供了少部分用于设置网格其他部分(如列题头和行题头)格式的额外属性。</strong></p>
<center>基于样式的DataGrid属性</center>
<table>
<thead>
<tr>
<th>属性</th>
<th>样式的适用范围</th>
</tr>
</thead>
<tbody>
<tr>
<td>ColumnHeaderStyle</td>
<td>位于网格顶部的列题头的TextBlock</td>
</tr>
<tr>
<td>RowHeaderStyle</td>
<td>行题头的TextBlock</td>
</tr>
<tr>
<td>DragIndicatorStyle</td>
<td>当用户正在将列题头拖动到新位置时用于列题头的TextBlock</td>
</tr>
<tr>
<td>RowStyle</td>
<td>用于普通行（在列中没有通过列的ElementStyle属性明确定制过的行）的TextBlock</td>
</tr>
</tbody>
</table>
<h3 id="设置行的格式">设置行的格式</h3>
<p>  通过设置 DataGrid 列对象的属性，可控制如何格式化整个列。但在许多情况下，标识包含特定数据的行更有用。例如，可能希望强调价格较高的产品和到期的装运。可通过处理DataGrid.LoadingRow 事件以编程方式应用此类格式。</p>
<p>  <em>对于设置行格式，LoadingRow 事件是个非常强大的工具。它提供了对当前行数据对象的访问，允许开发人员执行简单的范围检查、比较以及更复杂的操作。它还提供了行的 DataGridRow对象，允许开发人员使用不同的颜色或不同的字体设置行的格式。然而，不能只设置行中单个单元格的格式–为达到那样的目的,需要使用 DataGridTemplateColumn 和自定义的值转换器。</em></p>
<p>  当每一行出现在屏幕上时，就会立即为该行引发LoadingRow 事件。这种方法的优点是应用程序永远不必格式化整个网格;相反，只为当前可见的行引发LoadingRow 事件。但也有缺点:当用户在网格中滚动时，会连续引发LoadingRow 事件。因此，在LoadingRow方法中不能放置耗时的代码，除非希望慢慢地滚动。</p>
<p>  还有一个考虑事项:项容器再循环。为降低内存开销，当在数据中滚动时，DataGrid 控件为显示新数据而重用相同的 DataGridRow对象(这也是为什么将该事件称为LoadingRow而不是CreatingRow 的原因)。如有不慎,DataGrid 控件能够将数据加载到已经格式化了的 DataGridRow对象中。为了防止发生这种情况，必须明确地将每行恢复到其初始状态。</p>
<blockquote>
<p>下面的示例为价格较高的项提供明亮的橙色背景，为正常价格的项提供标准的白色背景：</p>
</blockquote>
<img src= "/img/loading.gif" data-lazy-src="https://cnlicm-blog-image.oss-cn-shenzhen.aliyuncs.com/img/20240808195619.png"/>
<div class="tabs" id="loadingrow"><ul class="nav-tabs"><button type="button" class="tab  active" data-href="loadingrow-1">MainWindow.xaml</button><button type="button" class="tab " data-href="loadingrow-2">MainWindow.xaml.cs</button></ul><div class="tab-contents"><div class="tab-item-content active" id="loadingrow-1"><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">DataGrid</span></span></span><br><span class="line"><span class="tag">        <span class="attr">AutoGenerateColumns</span>=<span class="string">&quot;True&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">ItemsSource</span>=<span class="string">&quot;&#123;Binding Products&#125;&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">LoadingRow</span>=<span class="string">&quot;DataGrid_OnLoadingRow&quot;</span> /&gt;</span></span><br></pre></td></tr></table></figure></div><div class="tab-item-content" id="loadingrow-2"><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> SolidColorBrush highlightBrush = <span class="keyword">new</span> SolidColorBrush(Colors.Orange);</span><br><span class="line"><span class="keyword">private</span> SolidColorBrush normalBrush = <span class="keyword">new</span> SolidColorBrush(Colors.White);</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">DataGrid_OnLoadingRow</span>(<span class="params"><span class="built_in">object</span>? sender, DataGridRowEventArgs e</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    Product product = e.Row.DataContext <span class="keyword">as</span> Product;</span><br><span class="line">    <span class="keyword">if</span> (product != <span class="literal">null</span> &amp;&amp; product.UnitCost &gt; <span class="number">1000</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        e.Row.Background = highlightBrush;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        e.Row.Background = normalBrush;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div></div><div class="tab-to-top"><button type="button" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div>
<div class="note warning flat"><p>只有当加载了行之后，才会应用在 LoadingRow 事件处理程序中应用的格式。如果编辑行，那么不会触发 [oadingRow 代码(至少在将行滚动出视图，然后在将其滚动回视图之前，不会触发 LoadingRow 代码)。</p>
</div>
<h3 id="显示行细节">显示行细节</h3>
<p>  DataGrid 控件还支持行细节(row details)一块可选的独立显示区域，在行的列值的下面显示。行细节区域添加了无法仅使用列实现的两个特征:</p>
<ul>
<li>能够跨越<code>DataGrid</code>控件的整个宽度，并且不会切入到独立的列中，从而提供了更多可供使用的空间</li>
<li>可配置行细节区域，从而只为选择的行显示该区域，当不需要时允许用户折叠额外的细节</li>
</ul>
<blockquote>
<p>下例显示了一个使用这两种行为的<code>DataGrid</code>控件。行细节区域显示能有换行的产品描述文本，并且只为当前选择的产品显示该描述文本</p>
</blockquote>
<img src= "/img/loading.gif" data-lazy-src="https://cnlicm-blog-image.oss-cn-shenzhen.aliyuncs.com/img/20240808200819.png"/>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">DataGrid</span> <span class="attr">AutoGenerateColumns</span>=<span class="string">&quot;False&quot;</span> <span class="attr">ItemsSource</span>=<span class="string">&quot;&#123;Binding Products&#125;&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">DataGrid.Columns</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">DataGridTextColumn</span> <span class="attr">Binding</span>=<span class="string">&quot;&#123;Binding ModelName&#125;&quot;</span> <span class="attr">Header</span>=<span class="string">&quot;Name&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">DataGridTextColumn</span> <span class="attr">Binding</span>=<span class="string">&quot;&#123;Binding ModelNumber&#125;&quot;</span> <span class="attr">Header</span>=<span class="string">&quot;Number&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">DataGridTextColumn</span> <span class="attr">Binding</span>=<span class="string">&quot;&#123;Binding UnitCost&#125;&quot;</span> <span class="attr">Header</span>=<span class="string">&quot;UnitCost&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">DataGrid.Columns</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">DataGrid.RowDetailsTemplate</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">DataTemplate</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">Border</span></span></span><br><span class="line"><span class="tag">                <span class="attr">BorderBrush</span>=<span class="string">&quot;SteelBlue&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">BorderThickness</span>=<span class="string">&quot;3&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">CornerRadius</span>=<span class="string">&quot;3&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">Margin</span>=<span class="string">&quot;10&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">Padding</span>=<span class="string">&quot;10&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">TextBlock</span> <span class="attr">Text</span>=<span class="string">&quot;&#123;Binding Description&#125;&quot;</span> <span class="attr">TextWrapping</span>=<span class="string">&quot;Wrap&quot;</span> /&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">Border</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">DataTemplate</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">DataGrid.RowDetailsTemplate</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">DataGrid</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>  可通过设置 DataGrid.RowDetailsVisibilityMode 属性来配置行细节区域的显示行为。默认情况下，该属性设置为 VisibleWhenSelected，这意味着显示所选行的行细节区域。另外，也可将其设置为 Visible，这意味着会同时显示所有行的细节区域。还可将该属性设置为Collapsed，这意味着不会为任何行显示细节区域–至少在使用代码修改 RowDetailsVisibilityMode 属性(例如,当用户选择特定类型的行时)之前是这样的。</p>
<h3 id="冻结列">冻结列</h3>
<p>  冻结的列位于 DataGrid 控件的左边，甚至当向石滚动时冻结的列仍然位于左边。下图显示了冻结的 Product列在滚动期间如何保持可见。注意水平滚动条只在可滚动的列下面伸展而不会伸展到冻结列的下面。</p>
<p>  对于非常宽的网格，列冻结是非常有用的特性，当希望确保特定信息(如产品名或唯一标识符)总是可见时尤其如此。为使用该特性，将DataGrid.FrozenColumn属性设置为大于0的数。例如，数值1只冻结第一列:</p>
<img src= "/img/loading.gif" data-lazy-src="https://cnlicm-blog-image.oss-cn-shenzhen.aliyuncs.com/img/WpfApp_cWKAbUC6oH.gif"/>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">DataGrid</span></span></span><br><span class="line"><span class="tag">    <span class="attr">AutoGenerateColumns</span>=<span class="string">&quot;False&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">FrozenColumnCount</span>=<span class="string">&quot;1&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">ItemsSource</span>=<span class="string">&quot;&#123;Binding Products&#125;&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">DataGrid.Columns</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">DataGridTextColumn</span></span></span><br><span class="line"><span class="tag">            <span class="attr">Binding</span>=<span class="string">&quot;&#123;Binding ModelName&#125;&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">Header</span>=<span class="string">&quot;Name&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">Width</span>=<span class="string">&quot;100&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">DataGridTextColumn</span></span></span><br><span class="line"><span class="tag">            <span class="attr">Binding</span>=<span class="string">&quot;&#123;Binding ModelNumber&#125;&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">Header</span>=<span class="string">&quot;Number&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">Width</span>=<span class="string">&quot;100&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">DataGridTextColumn</span></span></span><br><span class="line"><span class="tag">            <span class="attr">Binding</span>=<span class="string">&quot;&#123;Binding UnitCost&#125;&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">Header</span>=<span class="string">&quot;UnitCost&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">Width</span>=<span class="string">&quot;100&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">DataGridTextColumn</span></span></span><br><span class="line"><span class="tag">            <span class="attr">Binding</span>=<span class="string">&quot;&#123;Binding Description&#125;&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">Header</span>=<span class="string">&quot;Description&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">Width</span>=<span class="string">&quot;100&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">DataGrid.Columns</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">DataGrid</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>  冻结的列必须总是位于网格的左侧。如果冻结一列，该列是最左边的列;如果结两列，它们将是左边的前两列，等等。</p>
<h3 id="选择">选择</h3>
<p>  与普通的列表控件类似，DataGrid控件允许用户选择单个项。当选择一项时，可以响成SelectionChanged 事件。为找到当前选择的数据对象，可使用Selectedltem属性。如果希望用户能够选择多行，将 SelectionMode属性设置为 Extended(唯一的另一个选项是 Single，这也是默认选项)。为了选择多行，用户必须按下Shif或Cl键。可从SelectedItems属性中检索所选项的集合。</p>
<div class="note info flat"><p>可使用 SelectedItem 属性通过代码设置选择的项。如果将选择的项设置为当前视图以外的项，那么接着调用 DataGrid.ScrolltoView()方法是个好主意，这会强制 DataGrid 控件向前或向后滚动，直到指定的项可见。</p>
</div>
<h3 id="排序">排序</h3>
<p>  <strong>DataGrid 控件内置了排序功能,只要绑定到实现了 IList 接口的集合(如 List<T>和 Observable-Collection<T>集合)，DataGrid 控件就可以自动获得排序功能。</strong></p>
<p>  为执行排序，用户需要单击列题头。单击一次会根据列的数据类型以升序排序(例如，数字从0向上排序，字母按照字母顺序进行排序)，再次单击该列会翻转排序顺序。在列题头的右边会显示一个箭头，指示根据列中的值对 DataGrid 进行排序。对于升序排序，箭头指向上方;对于降序排序，箭头指向下方。</p>
<p>  通常，DataGrid 排序算法使用在列中显示的绑定数据，这是合理的。然而，**可通过设置列的 SortMemberPath 属性从绑定的数据对象中选择不同属性。**并且如果有一个 DataGridTemplateColumn 列，就需要使用 SortMemberPath 属性，因为没有绑定属性提供绑定的数据。如果不这么做，该列就不支持排序。</p>
<p>  还可通过将 CanUserSortColumns属性设置为 false来禁用排序(或通过设置列的 CanUserSort<br>
属性，为特定列禁用排序功能)。</p>
<h3 id="编辑">编辑</h3>
<p>  <code>DataGrid</code>控件的最方便之处在于支持编辑。当用户双击<code>DataGrid</code>单元格时，该单元格会切换到编辑模式。但<code>DataGrid</code>控件以几中方式限制这种编辑功能：</p>
<ul>
<li><strong>DataGrid.IsReadOnly</strong>：当该属性为true时，用户不能编辑任何内容</li>
<li><strong>DataGridColumn.IsReadOnly</strong>：当该元素为true时，用户不能编辑该列中的任意值</li>
<li><strong>只读属性</strong>：如果数据对象具有没有属性设置器的属性，DataGrid控件将足够智能，它能够注意到该细节，并且禁用列编辑，就像已将<code>DataGridColumn.IsReadOnly</code>属性设置为true一样。类似的，**如果属性不是简单的文本、数字或日期类型，DataGrid控件使其为只读(但可通过切换到DataGridTemplateColumn来不就这种情况)</li>
</ul>
<p>  当单元格切换到编辑模式时发生的变化取决于列的类型。DataGridTextColumn 显示文本框(尽管该文本框的外观是无缝的，填满整个单元格并且没有可见的边框)。DataGridCheckBox 列显示可选中或取消选中的复选框。DataGridTempiateColumn 是到目前为止最有趣的，它允许使用更专业的输入控件替换标准的编辑文本框。</p>
<p>  例如，下面的列显示日期。当用户双击以编辑该值时，单元格就会变成具有预先选择的当前值的下拉DatePicker控件：</p>
<img src= "/img/loading.gif" data-lazy-src="https://cnlicm-blog-image.oss-cn-shenzhen.aliyuncs.com/img/WpfApp_QiLkjK5StT.gif"/>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">DataGridTemplateColumn</span> <span class="attr">Header</span>=<span class="string">&quot;Date Added&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">DataGridTemplateColumn.CellTemplate</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">DataTemplate</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">TextBlock</span> <span class="attr">Margin</span>=<span class="string">&quot;4&quot;</span> <span class="attr">Text</span>=<span class="string">&quot;&#123;Binding DateAdded, StringFormat=&#123;&#125;&#123;0:yyyy/MM/dd HH:mm:ss&#125;&#125;&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">DataTemplate</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">DataGridTemplateColumn.CellTemplate</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">DataGridTemplateColumn.CellEditingTemplate</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">DataTemplate</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">DatePicker</span> <span class="attr">SelectedDate</span>=<span class="string">&quot;&#123;Binding DateAdded, Mode=TwoWay&#125;&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">DataTemplate</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">DataGridTemplateColumn.CellEditingTemplate</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">DataGridTemplateColumn</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>  DataGrid 控件自动支持基本验证系统，该系统响应在数据绑定系统中的问题(例如不能将提供的文本转换为合适的数据类型)以及由属性设置器抛出的异常。下面的示例使用自定义的验证规则验证 UnitCost 字段:</p>
<img src= "/img/loading.gif" data-lazy-src="https://cnlicm-blog-image.oss-cn-shenzhen.aliyuncs.com/img/20240808203916.png"/>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">DataGridTextColumn</span> <span class="attr">Header</span>=<span class="string">&quot;UnitCost&quot;</span> <span class="attr">Width</span>=<span class="string">&quot;100&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">DataGridTextColumn.Binding</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">Binding</span> <span class="attr">Path</span>=<span class="string">&quot;UnitCost&quot;</span> <span class="attr">StringFormat</span>=<span class="string">&quot;&#123;&#125;&#123;0:C&#125;&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">Binding.ValidationRules</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">validates:PositivePriceRule</span> <span class="attr">Max</span>=<span class="string">&quot;999.99&quot;</span> /&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">Binding.ValidationRules</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">Binding</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">DataGridTextColumn.Binding</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">DataGridTextColumn</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>  为DataGridCell提供的默认<code>ErrorTemplate</code>模板在非法值的周围显示红色的外边框，与其他输入控件（如文本框）相似。</p>
<p>  可通过其他几种方法为DataGrid控件实现验证。一种选择是使用DataGrid控件的编辑事件下表列出了这些编辑事件。列出这些事件的顺序也是在 DataGrid 控件中引发这些事件的顺序,</p>
<center>DataGrid控件的编辑事件</center>
<table>
<thead>
<tr>
<th>名称</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>BeginningEdit</td>
<td>当单元格正进入编辑模式时发生。可检查当前编辑的列和行，检查单元格的值，并且可使用<code>DataGridBeginningEditEventArgs.Cancel</code>属性取消操作</td>
</tr>
<tr>
<td>PreparingCellForEdit</td>
<td>用于模板列。这时，可为编辑控件执行所有最后的初始化操作。可使用<code>DataGridPreparingCellForEditEventArgs.EditingElement访问CellEditingTemplate</code>中的元素</td>
</tr>
<tr>
<td>CellEditEnding</td>
<td>当单元格正退出编辑模式时发生。DataGridCellEditEndingEventsArgs.EditAction 指示用户是试图接受编辑(例如，通过按下 Enter键或单击另一个单元格)，还是取消编辑(通过按下Escape 键)。可检查新数据并设置Cancel属性以回滚修改</td>
</tr>
<tr>
<td>RowEditEnding</td>
<td>当用户在编辑完当前行之后导航到新行时发生。与CellEditEnding事件一样，可使用该事件执行验证并取消修改。通常，将在此执行涉及几列的验证–例如，确保某列中的值大于另一列中的值</td>
</tr>
</tbody>
</table>
<p>  如果需要在某个地方执行特定于页面的验证逻辑(从而不会结合到数据对象中)，可编写响应 CellEditEnding 和 RowEditEnding 事件的自定义验证逻辑。在 CellEditEnding 事件处理程序中检查列规则，并在 RowEditEnding 事件中验证整行的一致性。请记住，如果取消编辑，应当为发生的问题提供解释(通常是在页面其他地方的 TextBlock 控件中显示解释)。</p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>文章作者: </span><span class="post-copyright-info"><a href="http://bootree.cn">大白</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>文章链接: </span><span class="post-copyright-info"><a href="http://bootree.cn/2024/08/04/WPF%E7%BC%96%E7%A8%8B%E5%AE%9D%E5%85%B8/22%E5%88%97%E8%A1%A8%E3%80%81%E6%A0%91%E5%92%8C%E7%BD%91%E6%A0%BC/">http://bootree.cn/2024/08/04/WPF%E7%BC%96%E7%A8%8B%E5%AE%9D%E5%85%B8/22%E5%88%97%E8%A1%A8%E3%80%81%E6%A0%91%E5%92%8C%E7%BD%91%E6%A0%BC/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="external nofollow noreferrer" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="http://bootree.cn" target="_blank">生活中的tree</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/WPF%E7%BC%96%E7%A8%8B%E5%AE%9D%E5%85%B8/">WPF编程宝典</a></div><div class="post_share"><div class="social-share" data-image="https://cnlicm-blog-image.oss-cn-shenzhen.aliyuncs.com/img/wpf.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://jsd.012700.xyz/npm/butterfly-extsrc@1.1.3/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://jsd.012700.xyz/npm/butterfly-extsrc@1.1.3/sharejs/dist/js/social-share.min.js" defer></script></div></div><div class="post-reward"><div class="reward-button"><i class="fas fa-qrcode"></i>赞助</div><div class="reward-main"><ul class="reward-all"><li class="reward-item"><a href="/img/wechat.jpg" target="_blank"><img class="post-qr-code-img" src= "/img/loading.gif" data-lazy-src="/img/wechat.jpg" alt="微信"/></a><div class="post-qr-code-desc">微信</div></li><li class="reward-item"><a href="/img/alipay.jpg" target="_blank"><img class="post-qr-code-img" src= "/img/loading.gif" data-lazy-src="/img/alipay.jpg" alt="支付宝"/></a><div class="post-qr-code-desc">支付宝</div></li></ul></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2024/08/08/WPF%E7%BC%96%E7%A8%8B%E5%AE%9D%E5%85%B8/23%E7%AA%97%E5%8F%A3/" title="WPF编程宝典 - 23窗口"><img class="cover" src= "/img/loading.gif" data-lazy-src="https://cnlicm-blog-image.oss-cn-shenzhen.aliyuncs.com/img/wpf.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">WPF编程宝典 - 23窗口</div></div></a></div><div class="next-post pull-right"><a href="/2024/08/04/WPF%E7%BC%96%E7%A8%8B%E5%AE%9D%E5%85%B8/21%E6%95%B0%E6%8D%AE%E8%A7%86%E5%9B%BE/" title="WPF编程宝典 - 21数据视图"><img class="cover" src= "/img/loading.gif" data-lazy-src="https://cnlicm-blog-image.oss-cn-shenzhen.aliyuncs.com/img/wpf.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">WPF编程宝典 - 21数据视图</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><div><a href="/2024/05/23/WPF%E7%BC%96%E7%A8%8B%E5%AE%9D%E5%85%B8/02XAML/" title="WPF编程宝典 - 02XAML"><img class="cover" src= "/img/loading.gif" data-lazy-src="https://cnlicm-blog-image.oss-cn-shenzhen.aliyuncs.com/img/20240527195528.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2024-05-23</div><div class="title">WPF编程宝典 - 02XAML</div></div></a></div><div><a href="/2024/05/22/WPF%E7%BC%96%E7%A8%8B%E5%AE%9D%E5%85%B8/01%E6%A6%82%E8%BF%B0/" title="WPF编程宝典 - 01概述"><img class="cover" src= "/img/loading.gif" data-lazy-src="https://cnlicm-blog-image.oss-cn-shenzhen.aliyuncs.com/img/wpf.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2024-05-22</div><div class="title">WPF编程宝典 - 01概述</div></div></a></div><div><a href="/2024/05/24/WPF%E7%BC%96%E7%A8%8B%E5%AE%9D%E5%85%B8/03%E5%B8%83%E5%B1%80/" title="WPF编程宝典 - 03布局"><img class="cover" src= "/img/loading.gif" data-lazy-src="https://cnlicm-blog-image.oss-cn-shenzhen.aliyuncs.com/img/20240527195817.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2024-05-24</div><div class="title">WPF编程宝典 - 03布局</div></div></a></div><div><a href="/2024/05/25/WPF%E7%BC%96%E7%A8%8B%E5%AE%9D%E5%85%B8/04%E4%BE%9D%E8%B5%96%E5%B1%9E%E6%80%A7/" title="WPF编程宝典 - 04依赖属性"><img class="cover" src= "/img/loading.gif" data-lazy-src="https://cnlicm-blog-image.oss-cn-shenzhen.aliyuncs.com/img/wpf.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2024-05-25</div><div class="title">WPF编程宝典 - 04依赖属性</div></div></a></div><div><a href="/2024/05/29/WPF%E7%BC%96%E7%A8%8B%E5%AE%9D%E5%85%B8/06%E6%8E%A7%E4%BB%B6/" title="WPF编程宝典 - 06控件"><img class="cover" src= "/img/loading.gif" data-lazy-src="https://cnlicm-blog-image.oss-cn-shenzhen.aliyuncs.com/img/wpf.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2024-05-29</div><div class="title">WPF编程宝典 - 06控件</div></div></a></div><div><a href="/2024/05/28/WPF%E7%BC%96%E7%A8%8B%E5%AE%9D%E5%85%B8/05%E8%B7%AF%E7%94%B1%E4%BA%8B%E4%BB%B6/" title="WPF编程宝典 - 05路由事件"><img class="cover" src= "/img/loading.gif" data-lazy-src="https://cnlicm-blog-image.oss-cn-shenzhen.aliyuncs.com/img/wpf.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2024-05-28</div><div class="title">WPF编程宝典 - 05路由事件</div></div></a></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src= "/img/loading.gif" data-lazy-src="/img/avatar.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">大白</div><div class="author-info__description">知足而上进，温柔且坚定</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">115</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">20</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">26</div></a></div><a id="card-info-btn" target="_blank" rel="noopener external nofollow noreferrer" href="https://github.com/cnlicm"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/cnlicm" rel="external nofollow noreferrer" target="_blank" title="Github"><i class="fab fa-github" style="color: #hdhfbb;"></i></a><a class="social-icon" href="mailto:codenobugs@foxmail.com" rel="external nofollow noreferrer" target="_blank" title="Email"><i class="fas fa-envelope" style="color: #000000;"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">A lazy guy. My dream is that generate electricity with love.</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content is-expand"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#listview%E6%8E%A7%E4%BB%B6"><span class="toc-number">1.</span> <span class="toc-text">ListView控件</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8gridview%E5%88%9B%E5%BB%BA%E5%88%97"><span class="toc-number">2.</span> <span class="toc-text">使用GridView创建列</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%94%B9%E5%8F%98%E5%88%97%E7%9A%84%E5%B0%BA%E5%AF%B8"><span class="toc-number">2.1.</span> <span class="toc-text">改变列的尺寸</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8D%95%E5%85%83%E6%A0%BC%E6%A8%A1%E6%9D%BF"><span class="toc-number">2.2.</span> <span class="toc-text">单元格模板</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%9B%E5%BB%BA%E8%87%AA%E5%AE%9A%E4%B9%89%E8%A7%86%E5%9B%BE"><span class="toc-number">2.3.</span> <span class="toc-text">创建自定义视图</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%A7%86%E5%9B%BE%E7%B1%BB"><span class="toc-number">2.3.1.</span> <span class="toc-text">视图类</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%A7%86%E5%9B%BE%E6%A0%B7%E5%BC%8F"><span class="toc-number">2.3.2.</span> <span class="toc-text">视图样式</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8listview%E6%8E%A7%E4%BB%B6"><span class="toc-number">2.3.3.</span> <span class="toc-text">使用ListView控件</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%B8%BA%E8%A7%86%E5%9B%BE%E4%BC%A0%E9%80%92%E4%BF%A1%E6%81%AF"><span class="toc-number">2.3.4.</span> <span class="toc-text">为视图传递信息</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#treeview%E6%8E%A7%E4%BB%B6"><span class="toc-number">3.</span> <span class="toc-text">TreeView控件</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%9B%E5%BB%BA%E6%95%B0%E6%8D%AE%E7%BB%91%E5%AE%9A%E7%9A%84treeview%E6%8E%A7%E4%BB%B6"><span class="toc-number">3.1.</span> <span class="toc-text">创建数据绑定的TreeView控件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8D%B3%E6%97%B6%E5%88%9B%E5%BB%BA%E8%8A%82%E7%82%B9"><span class="toc-number">3.2.</span> <span class="toc-text">即时创建节点</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#datagrid%E6%8E%A7%E4%BB%B6"><span class="toc-number">4.</span> <span class="toc-text">DataGrid控件</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%94%B9%E5%8F%98%E5%88%97%E7%9A%84%E5%B0%BA%E5%AF%B8%E4%B8%8E%E9%87%8D%E6%96%B0%E5%AE%89%E6%8E%92%E5%88%97"><span class="toc-number">4.1.</span> <span class="toc-text">改变列的尺寸与重新安排列</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%9A%E4%B9%89%E5%88%97"><span class="toc-number">4.2.</span> <span class="toc-text">定义列</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#datagridcheckboxcolumn"><span class="toc-number">4.2.1.</span> <span class="toc-text">DataGridCheckBoxColumn</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#datagridhyperlinkcoulmn"><span class="toc-number">4.2.2.</span> <span class="toc-text">DataGridHyperlinkCoulmn</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#datagridcomboboxcolumn"><span class="toc-number">4.2.3.</span> <span class="toc-text">DataGridComboBoxColumn</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#datagridtemplatecolumn"><span class="toc-number">4.2.4.</span> <span class="toc-text">DataGridTemplateColumn</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%AE%BE%E7%BD%AE%E5%88%97%E7%9A%84%E6%A0%BC%E5%BC%8F%E5%92%8C%E6%A0%B7%E5%BC%8F"><span class="toc-number">4.3.</span> <span class="toc-text">设置列的格式和样式</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%AE%BE%E7%BD%AE%E8%A1%8C%E7%9A%84%E6%A0%BC%E5%BC%8F"><span class="toc-number">4.4.</span> <span class="toc-text">设置行的格式</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%98%BE%E7%A4%BA%E8%A1%8C%E7%BB%86%E8%8A%82"><span class="toc-number">4.5.</span> <span class="toc-text">显示行细节</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%86%BB%E7%BB%93%E5%88%97"><span class="toc-number">4.6.</span> <span class="toc-text">冻结列</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%80%89%E6%8B%A9"><span class="toc-number">4.7.</span> <span class="toc-text">选择</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8E%92%E5%BA%8F"><span class="toc-number">4.8.</span> <span class="toc-text">排序</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BC%96%E8%BE%91"><span class="toc-number">4.9.</span> <span class="toc-text">编辑</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2024/11/09/IDE/Keil/AStyle%E6%A0%BC%E5%BC%8F%E5%8C%96%E5%B7%A5%E5%85%B7/" title="AStyle格式化工具"><img src= "/img/loading.gif" data-lazy-src="https://cnlicm-blog-image.oss-cn-shenzhen.aliyuncs.com/img/20241109172550.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="AStyle格式化工具"/></a><div class="content"><a class="title" href="/2024/11/09/IDE/Keil/AStyle%E6%A0%BC%E5%BC%8F%E5%8C%96%E5%B7%A5%E5%85%B7/" title="AStyle格式化工具">AStyle格式化工具</a><time datetime="2024-11-09T09:23:21.000Z" title="发表于 2024-11-09 17:23:21">2024-11-09</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/11/09/IDE/Rider/JetBrainsRider%E6%8F%92%E4%BB%B6%E6%B1%87%E6%80%BB/" title="JetBrainsRider插件汇总"><img src= "/img/loading.gif" data-lazy-src="https://cnlicm-blog-image.oss-cn-shenzhen.aliyuncs.com/img/20240902145915.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="JetBrainsRider插件汇总"/></a><div class="content"><a class="title" href="/2024/11/09/IDE/Rider/JetBrainsRider%E6%8F%92%E4%BB%B6%E6%B1%87%E6%80%BB/" title="JetBrainsRider插件汇总">JetBrainsRider插件汇总</a><time datetime="2024-11-09T09:21:50.000Z" title="发表于 2024-11-09 17:21:50">2024-11-09</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/11/09/IDE/Rider/JetBrainsRider%E5%BF%AB%E6%8D%B7%E9%94%AE/" title="JetBrainsRider快捷键"><img src= "/img/loading.gif" data-lazy-src="https://cnlicm-blog-image.oss-cn-shenzhen.aliyuncs.com/img/20240902145915.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="JetBrainsRider快捷键"/></a><div class="content"><a class="title" href="/2024/11/09/IDE/Rider/JetBrainsRider%E5%BF%AB%E6%8D%B7%E9%94%AE/" title="JetBrainsRider快捷键">JetBrainsRider快捷键</a><time datetime="2024-11-09T09:18:55.000Z" title="发表于 2024-11-09 17:18:55">2024-11-09</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/10/21/Circuits/PcbDesign/02%E5%98%89%E7%AB%8B%E5%88%9BEDA%E4%BD%BF%E7%94%A8/" title="02嘉立创EDA使用"><img src= "/img/loading.gif" data-lazy-src="https://cnlicm-blog-image.oss-cn-shenzhen.aliyuncs.com/img/20241020174157.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="02嘉立创EDA使用"/></a><div class="content"><a class="title" href="/2024/10/21/Circuits/PcbDesign/02%E5%98%89%E7%AB%8B%E5%88%9BEDA%E4%BD%BF%E7%94%A8/" title="02嘉立创EDA使用">02嘉立创EDA使用</a><time datetime="2024-10-21T12:08:46.000Z" title="发表于 2024-10-21 20:08:46">2024-10-21</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/10/20/Circuits/PcbDesign/01PCB%E7%AE%80%E4%BB%8B/" title="01PCB简介"><img src= "/img/loading.gif" data-lazy-src="https://cnlicm-blog-image.oss-cn-shenzhen.aliyuncs.com/img/20241020174157.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="01PCB简介"/></a><div class="content"><a class="title" href="/2024/10/20/Circuits/PcbDesign/01PCB%E7%AE%80%E4%BB%8B/" title="01PCB简介">01PCB简介</a><time datetime="2024-10-20T09:40:03.000Z" title="发表于 2024-10-20 17:40:03">2024-10-20</time></div></div></div></div></div></div></main><footer id="footer" style="background-image: url('https://cnlicm-blog-image.oss-cn-shenzhen.aliyuncs.com/img/wpf.png')"><div id="footer-wrap"><div class="copyright">&copy;2024 By 大白</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener external nofollow noreferrer" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener external nofollow noreferrer" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div><div class="footer_custom_text"><a target="_blank" rel="noopener external nofollow noreferrer" href="https://beian.miit.gov.cn/"><img class="icp-icon" src= "/img/loading.gif" data-lazy-src="/img/2020011362.png"><span>赣ICP备2020011362号-2</span></a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="translateLink" type="button" title="简繁转换">简</button><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="https://jsd.012700.xyz/npm/hexo-theme-butterfly@4.13.0/source/js/utils.min.js"></script><script src="https://jsd.012700.xyz/npm/hexo-theme-butterfly@4.13.0/source/js/main.min.js"></script><script src="https://jsd.012700.xyz/npm/hexo-theme-butterfly@4.13.0/source/js/tw_cn.min.js"></script><script src="https://jsd.012700.xyz/npm/@fancyapps/ui@5.0.33/dist/fancybox/fancybox.umd.min.js"></script><script src="https://jsd.012700.xyz/npm/instant.page@5.2.0/instantpage.min.js" type="module"></script><script src="https://jsd.012700.xyz/npm/vanilla-lazyload@17.8.8/dist/lazyload.iife.min.js"></script><div class="js-pjax"><script>(() => {
  const $mermaid = document.querySelectorAll('#article-container .mermaid-wrap')
  if ($mermaid.length === 0) return
  const runMermaid = () => {
    window.loadMermaid = true
    const theme = document.documentElement.getAttribute('data-theme') === 'dark' ? 'dark' : 'default'

    Array.from($mermaid).forEach((item, index) => {
      const mermaidSrc = item.firstElementChild
      const mermaidThemeConfig = '%%{init:{ \'theme\':\'' + theme + '\'}}%%\n'
      const mermaidID = 'mermaid-' + index
      const mermaidDefinition = mermaidThemeConfig + mermaidSrc.textContent

      const renderFn = mermaid.render(mermaidID, mermaidDefinition)

      const renderV10 = () => {
        renderFn.then(({svg}) => {
          mermaidSrc.insertAdjacentHTML('afterend', svg)
        })
      }

      const renderV9 = svg => {
        mermaidSrc.insertAdjacentHTML('afterend', svg)
      }

      typeof renderFn === 'string' ? renderV9(renderFn) : renderV10()
    })
  }

  const loadMermaid = () => {
    window.loadMermaid ? runMermaid() : getScript('https://jsd.012700.xyz/npm/mermaid@10.8.0/dist/mermaid.min.js').then(runMermaid)
  }

  btf.addGlobalFn('themeChange', runMermaid, 'mermaid')

  window.pjax ? loadMermaid() : document.addEventListener('DOMContentLoaded', loadMermaid)
})()</script></div><script data-pjax src="/self/btf.js"></script><script defer="defer" id="ribbon" src="https://jsd.012700.xyz/npm/butterfly-extsrc@1.1.3/dist/canvas-ribbon.min.js" size="150" alpha="0.6" zIndex="-1" mobile="true" data-click="true"></script><script src="https://jsd.012700.xyz/npm/pjax@0.2.8/pjax.min.js"></script><script>let pjaxSelectors = ["head > title","#config-diff","#body-wrap","#rightside-config-hide","#rightside-config-show",".js-pjax"]

var pjax = new Pjax({
  elements: 'a:not([target="_blank"]):not([href="/talking/"])',
  selectors: pjaxSelectors,
  cacheBust: false,
  analytics: false,
  scrollRestoration: false
})

document.addEventListener('pjax:send', function () {

  // removeEventListener
  btf.removeGlobalFnEvent('pjax')
  btf.removeGlobalFnEvent('themeChange')

  document.getElementById('rightside').classList.remove('rightside-show')
  
  if (window.aplayers) {
    for (let i = 0; i < window.aplayers.length; i++) {
      if (!window.aplayers[i].options.fixed) {
        window.aplayers[i].destroy()
      }
    }
  }

  typeof typed === 'object' && typed.destroy()

  //reset readmode
  const $bodyClassList = document.body.classList
  $bodyClassList.contains('read-mode') && $bodyClassList.remove('read-mode')

  typeof disqusjs === 'object' && disqusjs.destroy()
})

document.addEventListener('pjax:complete', function () {
  window.refreshFn()

  document.querySelectorAll('script[data-pjax]').forEach(item => {
    const newScript = document.createElement('script')
    const content = item.text || item.textContent || item.innerHTML || ""
    Array.from(item.attributes).forEach(attr => newScript.setAttribute(attr.name, attr.value))
    newScript.appendChild(document.createTextNode(content))
    item.parentNode.replaceChild(newScript, item)
  })

  GLOBAL_CONFIG.islazyload && window.lazyLoadInstance.update()

  typeof panguInit === 'function' && panguInit()

  // google analytics
  typeof gtag === 'function' && gtag('config', '', {'page_path': window.location.pathname});

  // baidu analytics
  typeof _hmt === 'object' && _hmt.push(['_trackPageview',window.location.pathname]);

  typeof loadMeting === 'function' && document.getElementsByClassName('aplayer').length && loadMeting()

  // prismjs
  typeof Prism === 'object' && Prism.highlightAll()
})

document.addEventListener('pjax:error', e => {
  if (e.request.status === 404) {
    pjax.loadUrl('/404.html')
  }
})</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据库加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div><hr/><div id="local-search-results"></div><div id="local-search-stats-wrap"></div></div></div><div id="search-mask"></div><script src="https://jsd.012700.xyz/npm/hexo-theme-butterfly@4.13.0/source/js/search/local-search.min.js"></script></div></div></body></html>